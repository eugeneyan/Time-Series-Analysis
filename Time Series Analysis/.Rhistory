summary(model0)
model1 <- lm(amt ~ launch + one_week_bf + I(one_week_bf^2) + two_week_bf + I(two_week_bf^2)+ three_week_bf + I(three_week_bf^3), data = japan_2011)
summary(model1)
points(japan_2011$launch,fitted(model1),col="red",pch=20)
plot(japan_total$amt ~ japan_total$week, pch = 20, col = japan_total$year)
plot(japan_2011$amt ~ japan_2011$week, pch = 20)
japan_2011 <- data.frame(amt = japan_total_2011, date = date_2011, year = rep(2011, 13), launch = launch_2011, one_week_bf = one_week_bf_2011, two_week_bf = two_week_bf_2011, three_week_bf = three_week_bf_2011, week = c(1:13))
View(japan_2011)
plot(japan_2011$amt ~ japan_2011$week, pch = 20)
model2 <- lm(amt ~ launch + one_week_bf*launch + two_week_bf + three_week_bf, data = japan_2011)
summary(model2)
model2 <- lm(amt ~ launch + one_week_bf*launch + two_week_bf*launch + three_week_bf, data = japan_2011)
summary(model2)
launch_2011 <- as.factor(c(rep('bf',3), 'launch', rep('af',9)))
japan_2011 <- data.frame(amt = japan_total_2011, date = date_2011, year = rep(2011, 13), launch = launch_2011, one_week_bf = one_week_bf_2011, two_week_bf = two_week_bf_2011, three_week_bf = three_week_bf_2011, week = c(1:13))
model2 <- lm(amt ~ launch + one_week_bf*launch + two_week_bf*launch + three_week_bf, data = japan_2011)
summary(model2)
model0 <- lm(amt ~ launch + one_week_bf + two_week_bf + three_week_bf, data = japan_2011)
summary(model0)
# week before values squared
model1 <- lm(amt ~ launch + one_week_bf + I(one_week_bf^2) + two_week_bf + I(two_week_bf^2)+ three_week_bf + I(three_week_bf^3), data = japan_2011)
summary(model1)
# interactions between launch and weeks before
model2 <- lm(amt ~ launch + one_week_bf*launch + two_week_bf*launch + three_week_bf, data = japan_2011)
summary(model2)
model2 <- lm(amt ~ launch + one_week_bf + one_week_bf*launch + two_week_bf*launch + three_week_bf, data = japan_2011)
summary(model2)
model2 <- lm(amt ~ launch + one_week_bf*launch + two_week_bf*launch + three_week_bf*launch, data = japan_2011)
summary(model2)
model0 <- lm(amt ~ launch + one_week_bf + I(one_week_bf^2)+ two_week_bf + three_week_bf, data = japan_2011)
summary(model0)
model0 <- lm(amt ~ launch + I(one_week_bf^2)+ two_week_bf + three_week_bf, data = japan_2011)
summary(model0)
model0 <- lm(amt ~ launch + I(one_week_bf^2)+ I(two_week_bf^2) + three_week_bf, data = japan_2011)
summary(model0)
model0 <- lm(amt ~ launch + I(one_week_bf^2)+ I(two_week_bf^2) + I(three_week_bf^2), data = japan_2011)
summary(model0)
level(launch_2011)
launch[1:13]
japan_2011$launch[1:13]
model0 <- lm(amt ~ launch + I(one_week_bf^2)+ I(two_week_bf^2) + I(three_week_bf^2), data = japan_2011)
summary(model0)
model0 <- lm(amt ~ launch + I(one_week_bf^2)+ I(two_week_bf^2), data = japan_2011)
summary(model0)
model0 <- lm(amt ~ launch + I(one_week_bf^2), data = japan_2011)
summary(model0)
model01 <- lm(amt ~ launch + I(one_week_bf^2), data = japan_2011)
model02 <- lm(amt ~ launch + I(one_week_bf^2) + I(two_week_bf^2), data = japan_2011)
summary(model01)
summary(model02)
model01 <- lm(amt ~ launch + I(one_week_bf^3), data = japan_2011)
summary(model01)
plot(model01)
model01 <- lm(amt ~ launch + I(one_week_bf^2), data = japan_2011)
model02 <- lm(amt ~ launch + I(one_week_bf^2) + I(two_week_bf^2), data = japan_2011)
summary(model01)
summary(model02)
plot(model01)
plot(model02)
plot(japan_2011$amt ~ japan_2011$week, pch = 20)
points(I(one_week_bf^2),fitted(model01),col="blue",pch=20)
points(I(one_week_bf^2),fitted(model01), data = japan_2011, col="blue",pch=20)
fit7=lm(medv~poly(lstat,4))
names(Boston)
?Boston
plot(medv~lstat,Boston)
fit1=lm(medv~lstat,data=Boston)
fit1
summary(fit1)
abline(fit1,col="red")
names(fit1)
confint(fit1)
predict(fit1,data.frame(lstat=c(5,10,15)),interval="confidence")
### Multiple linear regression
fit2=lm(medv~lstat+age,data=Boston)
summary(fit2)
fit3=lm(medv~.,Boston)
summary(fit3)
par(mfrow=c(2,2))
plot(fit3)
fit4=update(fit3,~.-age-indus)
summary(fit4)
### Nonlinear terms and Interactions
fit5=lm(medv~lstat*age,Boston)
summary(fit5)
fit6=lm(medv~lstat +I(lstat^2),Boston); summary(fit6)
attach(Boston)
par(mfrow=c(1,1))
plot(medv~lstat)
points(lstat,fitted(fit6),col="red",pch=20)
attach(japan_2011)
points(one_week_bf,fitted(model01), data = japan_2011, col="blue",pch=20)
plot(medv~lstat)
points(lstat,fitted(fit6),col="red",pch=20)
plot(japan_2011$amt ~ japan_2011$week)
points(one_week_bf,fitted(model01), col="blue",pch=20)
View(japan_2011$one_week_bf)
points(amt,fitted(model01), col="blue",pch=20)
plot(japan_2011$amt ~ japan_2011$week)
points(amt,fitted(model01), col="blue",pch=20)
plot(medv~lstat)
points(lstat,fitted(fit6),col="red",pch=20)
points(week,fitted(model01), col="blue",pch=20)
fit7=lm(medv~poly(lstat,4))
points(lstat,fitted(fit7),col="blue",pch=20)
?points
plot(japan_2011$amt ~ japan_2011$week)
points(week, fitted(model01), col="blue",pch=20)
points(japans_2011$week, fitted(model01), col="blue",pch=20)
points(japan_2011$week, fitted(model01), col="blue",pch=20)
?points
plot(medv~lstat)
points(lstat,fitted(fit6),col="red",pch=20)
fit7=lm(medv~poly(lstat,4))
points(lstat,fitted(fit7),col="blue",pch=20)
points(japan_2011$year, fitted(model01), col="blue",pch=20)
plot(japan_2011$amt ~ japan_2011$week)
points(japan_2011$amt, fitted(model01), col="blue",pch=20)
model01$fitted
points(japan_2011$amt, model01$fitted, col="blue",pch=20)
points(japan_2011$week, model01$fitted, col="blue",pch=20)
model01$fitted
japan_2011$week
length(model01$fitted)
length(japan_2011$week)
points(2:12, model01$fitted, col="blue",pch=20)
points(2:13, model01$fitted, col="blue",pch=20)
plot(japan_2011$amt ~ japan_2011$week, col = "red")
points(2:13, model01$fitted, col="blue",pch=20)
plot(japan_2011$amt ~ japan_2011$week, col = "red", pch=20)
points(2:13, model01$fitted, col="blue",pch=20)
plot(model01)
plot(japan_2011$amt ~ japan_2011$week, col = "red", pch=20)
points(2:13, model01$fitted, col="blue",pch=20)
points(2:13, model02$fitted, col="green",pch=20)
points(2:13, model02$fitted, col="green",pch=20)
points(3:13, model02$fitted, col="green",pch=20)
# week before values squared
plot(japan_2011$amt ~ japan_2011$week, col = "red")
points(2:13, model01$fitted, col="blue")
points(3:13, model02$fitted, col="green")
model01 <- lm(amt ~ launch + I(one_week_bf^2), data = japan_2011)
model02 <- lm(amt ~ launch + I(one_week_bf^2) + I(two_week_bf^2), data = japan_2011)
summary(model01)
summary(model02)
plot(model01)
plot(model02)
gas  <- read.xlsx(xl_file, sheetIndex = 1, colIndex = colI, rowIndex = rowI)
colI <- 3:16
rowI <- 26
xl_file <- 'iShades APAC v1.1.xlsx'
gas  <- read.xlsx(xl_file, sheetIndex = 1, colIndex = colI, rowIndex = rowI)
warnings()
xl_file <- 'iShades APAC v1.1.xlsx'
gas  <- read.xlsx(xl_file, sheetIndex = 1, colIndex = colI, rowIndex = rowI)
getwd()
gas  <- read.xlsx(xl_file, colIndex = colI, rowIndex = rowI)
?read.xlsx
gas  <- read.xlsx(xl_file, sheetName = 'Case', colIndex = colI, rowIndex = rowI)
gas  <- read.xlsx(xl_file, sheetName = Case, colIndex = colI, rowIndex = rowI)
xl_file <- 'iShades APAC v1.1.xlsx'
gas  <- read.xlsx(xl_file, sheetName = 'Case', colIndex = colI, rowIndex = rowI)
rowI <- 17
xl_file <- 'iShades APAC v1.1.xlsx'
gas  <- read.xlsx(xl_file, sheetName = 'Case', colIndex = colI, rowIndex = rowI)
colI <- 1:16
rowI <- 17
xl_file <- 'iShades APAC v1.1.xlsx'
gas  <- read.xlsx(xl_file, sheetName = 'Case', colIndex = colI, rowIndex = rowI)
sa_total_2011 <- c(2375, 2172, 2033, 4573, 5545, 4436, 3549, 3371, 3203, 3042, 2982, 3041, 3072)
nz_total_2011 <- c(3700, 3333, 3119, 7018, 8509, 6807, 5446, 5173, 4915, 4669, 4576, 4667, 4714)
japan_total_2011n <- scale(japan_total_2011)
View(japan_total_2011n)
japan_total_2011n <- scale(japan_total_2011)
sa_total_2011n <- scale(sa_total_2011)
nz_total_2011n <- scale(nz_total_2011)
plot(japan_total_2011n ~ 1:13)
weeks <- 1:13
plot(japan_total_2011n ~ weeks)
points(sa_total_2011n ~ weeks)
points(nz_total_2011n ~ weeks)
plot(japan_total_2011n ~ weeks, color = "red", pch = 20)
plot(japan_total_2011n ~ weeks, colour = "red", pch = 20)
plot(japan_total_2011n ~ weeks, col= "red", pch = 20)
points(nz_total_2011n ~ weeks, col="green", pch=20)
points(sa_total_2011n ~ weeks, col="blue", pch = 20)
japan_total_2011n <- scale(japan_total_2011)
sa_total_2011n <- scale(sa_total_2011)
nz_total_2011n <- scale(nz_total_2011)
weeks <- 1:13
plot(japan_total_2011n ~ weeks, col="red", pch = 20)
points(sa_total_2011n ~ weeks, col="blue", pch = 20)
points(nz_total_2011n ~ weeks, col="green", pch=20)
?cor
cor(japan_total_2011n, sa_total_2011n)
total_2011n <- data.frame(jp = japan_total_2011n, sa = sa_total_2011n, nz = nz_total_2011n)
cor(total_2011n)
total_2011n <- data.frame(jp = japan_total_2011n, sa = sa_total_2011n, nz = nz_total_2011n)
plot(japan_total_2011n ~ weeks, col="red", pch = 20, type = "l")
lines(sa_total_2011n ~ weeks, col="blue", pch = 20)
lines(nz_total_2011n ~ weeks, col="green", pch=20)
legend ('topright', c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
legend (2000, 9.5, c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
legend (2000, 9.5, c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
plot(japan_total_2011n ~ weeks, col="red", pch = 20, type = "l")
lines(sa_total_2011n ~ weeks, col="blue", pch = 20)
lines(nz_total_2011n ~ weeks, col="green", pch=20)
legend (2000, 9.5, c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
legend (10, 9.5, c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
legend (10, 10, c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
legend (100, 10, c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
legend(100, 100, c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
?legend
legend(x = 100, y = 100, c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
legend('topright', c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
xlab = "Weeks in 2011 3Q"
plot(japan_total_2011n ~ weeks, col="red", pch = 20, type = "l", xlab = "Weeks in 2011 3Q")
plot(japan_total_2011n ~ weeks, col="red", pch = 20, type = "l", xlab = "Weeks in 2011 3Q", ylab = 'Sales(normalized)')
plot(japan_total_2011n ~ weeks, col="red", pch = 20, type = "l", xlab = "Weeks in 2011 3Q", ylab = 'Sales (normalized)')
lines(sa_total_2011n ~ weeks, col="blue", pch = 20)
lines(nz_total_2011n ~ weeks, col="green", pch=20)
legend('topright', c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
plot(japan_total_2011n ~ weeks, col="red", pch = 20, type = "l", main = "Plot of sales in JP, SA & NZ in 2011 3Q", xlab = "Weeks in 2011 3Q", ylab = 'Sales (normalized)')
plot(japan_total_2011n ~ weeks, col="red", pch = 20, type = "l", main = "Plot of iShades sales in JP, SA & NZ in 2011 3Q", xlab = "Weeks in 2011 3Q", ylab = 'Sales (normalized)')
lines(sa_total_2011n ~ weeks, col="blue", pch = 20)
lines(nz_total_2011n ~ weeks, col="green", pch=20)
legend('topright', c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
weeks <- c(1:13, 3)
weeks <- c(rep(1:13, 3)
weeks <- c(rep(1:13, 3))
weeks <- c(rep(1:13, 3))
weeks
country <- c(rep('JP', 13), rep('SA', 13), rep('NZ', 13))
country
total_2011n <- data.frame(jp = jp_total_2011n, sa = sa_total_2011n, nz = nz_total_2011n)
jp_total_2011n <- scale(jp_total_2011)
jp_total_2011 <- c(5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648, 6597, 6795, 6659)
sa_total_2011 <- c(2375, 2172, 2033, 4573, 5545, 4436, 3549, 3371, 3203, 3042, 2982, 3041, 3072)
nz_total_2011 <- c(3700, 3333, 3119, 7018, 8509, 6807, 5446, 5173, 4915, 4669, 4576, 4667, 4714)
cor(jp_total_2011n)
jp_total_2011n <- scale(jp_total_2011)
sa_total_2011n <- scale(sa_total_2011)
nz_total_2011n <- scale(nz_total_2011)
total_2011n <- data.frame(jp = jp_total_2011n, sa = sa_total_2011n, nz = nz_total_2011n)
# correlation check
cor(jp_total_2011n)
cor(total_2011n)
sa_one_week_bf_2011 <- c(NA, 2375, 2172, 2033, 4573, 5545, 4436, 3549, 3371, 3203, 3042, 2982, 3041)
jp_one_week_bf_2011 <- c(NA, 5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648, 6597, 6795)
jp_two_week_bf_2011 <- c(NA, NA, 5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648, 6597)
sa_one_week_bf_2011 <- c(NA, 2375, 2172, 2033, 4573, 5545, 4436, 3549, 3371, 3203, 3042, 2982, 3041)
sa_two_week_bf_2011 <- c(NA, NA, 2375, 2172, 2033, 4573, 5545, 4436, 3549, 3371, 3203, 3042, 2982)
nz_one_week_bf_2011 <- c(NA, 3700, 3333, 3119, 7018, 8509, 6807, 5446, 5173, 4915, 4669, 4576, 4667)
nz_two_week_bf_2011 <- c(NA, NA, 3700, 3333, 3119, 7018, 8509, 6807, 5446, 5173, 4915, 4669, 4576)
one_week_bf_2011 <- c(jp_one_week_bf_2011, sa_one_week_bf_2011, nz_one_week_bf_2011)
two_week_bf_2011 <- c(jp_two_week_bf_2011, sa_two_week_bf_2011, nz_two_week_bf_2011)
total_2011 <- c(jp_total_2011, sa_total_2011, nz_total_2011)
launch <- c(rep(rep('bf',3), 'launch', rep('af',9)), 3)
launch <- c(rep(rep('bf',3), 'launch', rep('af',9), 3)
launch <- c(rep(rep('bf',3), 'launch', rep('af',9), 3))
launch <- c(rep(rep('bf',3), 'launch', rep('af',9), 3))
launch <- c(rep(rep('bf',3), 'launch', rep('af',9)), 3)
launch
launch <- c(rep('bf',3), 'launch', rep('af',9))
launch
launch <- c(rep(rep('bf',3), 'launch', rep('af',9), 3)
launch <- c(rep(rep('bf',3), 'launch', rep('af',9), 3))
launch <- c(rep('bf',3), 'launch', rep('af',9), 3)
launch
launch <- c(rep((c(rep('bf',3), 'launch', rep('af',9), 3)), 3))
launch
launch <- c(rep((c(rep('bf',3), 'launch', rep('af',9), 3))))
launch
launch <- c(rep('bf',3), 'launch', rep('af',9), 3)
launch
launch <- c(rep('bf',3), 'launch', rep('af',9))
launch
launch <- c(rep((c(rep('bf',3), 'launch', rep('af',9))),3)
launch
launch <- c(rep((c(rep('bf',3), 'launch', rep('af',9))),3))
launch
total_2011n <- data.frame(amount = total_2011, one_week_bf = one_week_bf_2011, two_week_bf = two_week_bf_2011, country = country, weeks = weeks, launch = launch)
total_2011 <- data.frame(amount = total_2011, one_week_bf = one_week_bf_2011, two_week_bf = two_week_bf_2011, country = country, weeks = weeks, launch = launch)
rm('total_2011')
View(total_2011)
rm(list = ls())
total_2011 <- data.frame(amount = total_2011, one_week_bf = one_week_bf_2011, two_week_bf = two_week_bf_2011, country = country, weeks = weeks, launch = launch)
View(total_2011)
data_2011 <- data.frame(amount = total_2011, one_week_bf = one_week_bf_2011, two_week_bf = two_week_bf_2011, country = country, weeks = weeks, launch = launch)
jp_total_2011 <- c(5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648, 6597, 6795, 6659)
sa_total_2011 <- c(2375, 2172, 2033, 4573, 5545, 4436, 3549, 3371, 3203, 3042, 2982, 3041, 3072)
nz_total_2011 <- c(3700, 3333, 3119, 7018, 8509, 6807, 5446, 5173, 4915, 4669, 4576, 4667, 4714)
total_2011 <- c(jp_total_2011, sa_total_2011, nz_total_2011)
weeks <- c(rep(1:13, 3))
country <- c(rep('JP', 13), rep('SA', 13), rep('NZ', 13))
launch <- c(rep((c(rep('bf',3), 'launch', rep('af',9))),3))
jp_one_week_bf_2011 <- c(NA, 5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648, 6597, 6795)
jp_two_week_bf_2011 <- c(NA, NA, 5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648, 6597)
sa_one_week_bf_2011 <- c(NA, 2375, 2172, 2033, 4573, 5545, 4436, 3549, 3371, 3203, 3042, 2982, 3041)
sa_two_week_bf_2011 <- c(NA, NA, 2375, 2172, 2033, 4573, 5545, 4436, 3549, 3371, 3203, 3042, 2982)
nz_one_week_bf_2011 <- c(NA, 3700, 3333, 3119, 7018, 8509, 6807, 5446, 5173, 4915, 4669, 4576, 4667)
nz_two_week_bf_2011 <- c(NA, NA, 3700, 3333, 3119, 7018, 8509, 6807, 5446, 5173, 4915, 4669, 4576)
one_week_bf_2011 <- c(jp_one_week_bf_2011, sa_one_week_bf_2011, nz_one_week_bf_2011)
two_week_bf_2011 <- c(jp_two_week_bf_2011, sa_two_week_bf_2011, nz_two_week_bf_2011)
data_2011 <- data.frame(amount = total_2011, one_week_bf = one_week_bf_2011, two_week_bf = two_week_bf_2011, country = country, weeks = weeks, launch = launch)
View(total_2011)
View(data_2011)
plot(japan_total_2011n ~ weeks, col="red", pch = 20, type = "l", main = "Plot of iShades sales in JP, SA & NZ in 2011 3Q", xlab = "Weeks in 2011 3Q", ylab = 'Sales (normalized)')
jp_total_2011n <- scale(jp_total_2011)
sa_total_2011n <- scale(sa_total_2011)
nz_total_2011n <- scale(nz_total_2011)
plot(japan_total_2011n ~ weeks, col="red", pch = 20, type = "l", main = "Plot of iShades sales in JP, SA & NZ in 2011 3Q", xlab = "Weeks in 2011 3Q", ylab = 'Sales (normalized)')
plot(jp_total_2011n ~ weeks, col="red", pch = 20, type = "l", main = "Plot of iShades sales in JP, SA & NZ in 2011 3Q", xlab = "Weeks in 2011 3Q", ylab = 'Sales (normalized)')
week <- 1:13
plot(jp_total_2011n ~ week, col="red", pch = 20, type = "l", main = "Plot of iShades sales in JP, SA & NZ in 2011 3Q", xlab = "Weeks in 2011 3Q", ylab = 'Sales (normalized)')
lines(sa_total_2011n ~ week, col="blue", pch = 20)
lines(nz_total_2011n ~ week, col="green", pch=20)
legend('topright', c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
model0 <- lm(amount ~ launch + one_week_bf + two_week_bf + three_week_bf, country, data = data_2011)
model0 <- lm(amount ~ launch + one_week_bf + two_week_bf + country, data = data_2011)
summary(model0)
model01 <- lm(amount ~ launch + I(one_week_bf^2), country, data = data_2011)
model01 <- lm(amount ~ launch + I(one_week_bf^2) + country, data = data_2011)
model1 <- lm(amount ~ launch + I(one_week_bf^2) + country, data = data_2011)
summary(model1)
model2 <- lm(amount ~ launch + I(one_week_bf^2) + I(two_week_bf^2) + country, data = data_2011)
summary(model2)
plot(model1)
plot(model0)
model0 <- lm(amount ~ launch + one_week_bf + two_week_bf + country, data = data_2011)
summary(model0)
plot(model0)
model1 <- lm(amount ~ launch + I(one_week_bf^2) + country, data = data_2011)
summary(model1)
plot(model1)
model2 <- lm(amount ~ launch + I(one_week_bf^2) + I(two_week_bf^2) + country, data = data_2011)
summary(model2)
model2 <- lm(amount ~ launch + I(one_week_bf^2) + I(two_week_bf^2), data = data_2011)
summary(model2)
launch <- c(rep('bf',3), 'launch', rep('af',9))
jp_2011 <- data.frame(amount = jp_total_2011, one_week_bf = jp_one_week_bf_2011, two_week_bf = jp_two_week_bf_2012, launch = launch, week = week)
jp_2011 <- data.frame(amount = jp_total_2011, one_week_bf = jp_one_week_bf_2011, two_week_bf = jp_two_week_bf_2011, launch = launch, week = week)
model0 <- lm(amount ~ launch + one_week_bf + two_week_bf + country, data = japan_2011)
jp_2011 <- data.frame(amount = jp_total_2011, one_week_bf = jp_one_week_bf_2011, two_week_bf = jp_two_week_bf_2011, launch = launch, week = week)
model0 <- lm(amount ~ launch + one_week_bf + two_week_bf + country, data = jp_2011)
model0 <- lm(amount ~ launch + one_week_bf + two_week_bf, data = jp_2011)
summary(model0)
plot(model0)
plot(model1)
model1 <- lm(amount ~ launch + I(one_week_bf^2), data = jp_2011)
summary(model1)
plot(model1)
model2 <- lm(amount ~ launch + I(one_week_bf^2) + I(two_week_bf^2), data = jp_2011)
summary(model2)
model0 <- lm(amount ~ launch + one_week_bf + two_week_bf, data = jp_2011)
summary(model0)
plot(model0)
model1 <- lm(amount ~ launch + I(one_week_bf^2), data = jp_2011)
summary(model1)
plot(model1)
model2 <- lm(amount ~ launch + I(one_week_bf^2) + I(two_week_bf^2), data = jp_2011)
summary(model2)
plot(model2)
model2 <- lm(amount ~ launch*I(one_week_bf^2), data = jp_2011)
model3 <- lm(amount ~ launch*I(one_week_bf^2), data = jp_2011)
summary(model3)
plot(model3)
model1 <- lm(amount ~ launch + I(one_week_bf^2), data = jp_2011)
summary(model1)
model3 <- lm(amount ~ launch*I(one_week_bf^2), data = jp_2011)
summary(model3)
plot(model1)
model3 <- lm(amount ~ launch*I(one_week_bf^2), data = jp_2011)
summary(model3)
plot(model3)
plot(japan_2011$amt ~ japan_2011$week, col = "red")
plot(jp_2011$amt ~ jp_2011$week, col = "red")
plot(jp_2011$amount ~ jp_2011$week, col = "red")
points(2:13, model0$fitted, col="blue")
points(1:13, model0$fitted, col="blue")
model0$fitted
points(3:13, model0$fitted, col="blue")
points(2:13, model1$fitted, col="green")
points(3:13, model2$fitted, col="coral")
points(2:13, model2$fitted, col="coral")
plot(jp_2011$amount ~ jp_2011$week, col = "red", type = 'l')
lines(3:13, model0$fitted, col="blue")
lines(2:13, model1$fitted, col="green")
lines(2:13, model2$fitted, col="coral")
plot(jp_2011$amount ~ jp_2011$week, col = "red", type = 'l')
lines(2:13, model1$fitted, col="green")
lines(2:13, model2$fitted, col="coral")
model1 <- lm(amount ~ launch + I(one_week_bf^2), data = jp_2011)
summary(model1)
plot(model1)
model2 <- lm(amount ~ launch + I(one_week_bf^2) + I(two_week_bf^2), data = jp_2011)
summary(model2)
plot(model2)
plot(jp_2011$amount ~ jp_2011$week, col = "red", type = 'l')
lines(2:13, model3$fitted, col="black")
lines(2:13, model2$fitted, col="coral")
lines(2:13, model2$fitted, col="coral")
plot(jp_2011$amount ~ jp_2011$week, col = "red", type = 'l')
lines(3:13, model0$fitted, col="blue")
lines(2:13, model1$fitted, col="green")
lines(2:13, model2$fitted, col="coral")
lines(3:13, model2$fitted, col="coral")
lines(2:13, model3$fitted, col="black")
summary(model3)
plot(jp_2011$amount ~ jp_2011$week, col = "red", type = 'l')
lines(3:13, model0$fitted, col="blue")
lines(2:13, model1$fitted, col="green")
lines(3:13, model2$fitted, col="coral")
model0 <- lm(amount ~ launch + one_week_bf + two_week_bf, data = jp_2011)
summary(model0)
plot(model0)
plot(jp_2011$amount ~ jp_2011$week, col = "red", type = 'l')
lines(3:13, model0$fitted, col="blue")
summary(model1)
lines(2:13, model1$fitted, col="green")
lines(3:13, model2$fitted, col="blueviolet")
summary(model2)
aic(model0)
AIC(model0)
AIC(model1)
AIC(model2)
model4 <- lm(amount ~., data = jp_2011)
step <- stepAIC(model4, direction = "both")
library(MASS)
step <- stepAIC(model4, direction = "both")
yes
y
step <- stepAIC(model4, direction = "both")
step$anova
model4 <- lm(amount ~., data = jp_2011)
step <- stepAIC(model4, direction = "both")
y
yes
step <- stepAIC(model4, direction = "both")
model1 <- lm(amount ~ launch + I(one_week_bf^2), data = jp_2011)
summary(model1)
model0 <- lm(amount ~ launch + one_week_bf + two_week_bf, data = jp_2011)
summary(model0)
model0 <- lm(amount ~ launch + one_week_bf, data = jp_2011)
summary(model0)
jp_three_week_bf_2011 <- c(NA, NA, NA, 5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648)
jp_2011 <- data.frame(amount = jp_total_2011, one_week_bf = jp_one_week_bf_2011, two_week_bf = jp_two_week_bf_2011, three_week_bf = jp_three_week_bf_2011, launch = launch, week = week)
model0 <- lm(amount ~ launch + one_week_bf + two_week_bf + three_week_bf, data = jp_2011)
summary(model0)
model0 <- lm(amount ~ launch + one_week_bf + two_week_bf + three_week_bf, data = jp_2011)
summary(model0)
plot(model0)
model0 <- lm(amount ~ launch + one_week_bf + two_week_bf, data = jp_2011)
summary(model0)
model0 <- lm(amount ~ launch + one_week_bf, data = jp_2011)
summary(model0)
summary(model0)
model0 <- lm(amount ~ launch + one_week_bf + two_week_bf, data = jp_2011)
summary(model0)
AIC(model0)
model0b <- lm(amount ~ launch + one_week_bf + two_week_bf + three_week_bf, data = jp_2011)
summary(model0b)
AIC(model0b)
plot(jp_2011$amount ~ jp_2011$week, col = "red", type = 'l')
lines(3:13, model0$fitted, col="blue")
lines(3:13, model0$fitted, col="cyan")
plot(jp_2011$amount ~ jp_2011$week, col = "red", type = 'l')
lines(3:13, model0$fitted, col="blue")
lines(3:13, model0b$fitted, col="cyan")
lines(4:13, model0b$fitted, col="cyan")
plot(model0)
plot(model0b)
plot(model0)
plot(jp_2011$amount ~ jp_2011$week, col = "red", type = 'l')
lines(3:13, model0$fitted, col="blue")
lines(4:13, model0b$fitted, col="cyan")
lines(2:13, model1$fitted, col="green")
lines(3:13, model2$fitted, col="blueviolet")
model0a <- lm(amount ~ launch + one_week_bf, data = jp_2011)
summary(model0a)
lines(2:13, model0a$fitted, col="orange")
plot(jp_2011$amount ~ jp_2011$week, col = "red", type = 'l')
lines(3:13, model0$fitted, col="blue")
lines(2:13, model0a$fitted, col="orange")
lines(4:13, model0b$fitted, col="cyan")
plot(jp_total_2011n ~ week, col="red", pch = 20, type = "l", main = "Plot of iShades sales in JP, SA & NZ in 2011 3Q", xlab = "Weeks in 2011 3Q", ylab = 'Sales (normalized)')
lines(sa_total_2011n ~ week, col="blue", pch = 20)
lines(nz_total_2011n ~ week, col="green", pch=20)
legend('topright', c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
cor(total_2011n)
jp_total_2011n <- scale(jp_total_2011)
sa_total_2011n <- scale(sa_total_2011)
nz_total_2011n <- scale(nz_total_2011)
total_2011n <- data.frame(jp = jp_total_2011n, sa = sa_total_2011n, nz = nz_total_2011n)
# correlation check
cor(total_2011n)
jp_total_2012 <- c(7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA, NA, NA)
jp_one_week_bf_2012 <- c(NA, 7946, 6641, 5975, 5378, NA, NA, NA, NA, NA, NA, NA, NA)
jp_two_week_bf_2012 <- c(NA, 7946, 6641, 5975, 5378, NA, NA, NA, NA, NA, NA, NA, NA)
launch_2012 <- c(rep('bf', 5), 'launch', rep('af', 7))
newdata <- data.frame(amount = jp_total_2012, one_week_bf = jp_one_week_bf_2012, two_week_bf = jp_two_week_bf_2012, launch = launch_2012, week = week)
View(newdata)
predict(model0, newdata)
predict(model0, newdata)
jp_total_2012 <- c(7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA, NA, NA)
jp_one_week_bf_2012 <- c(NA, 7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA, NA)
jp_two_week_bf_2012 <- c(NA, NA, 7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA)
launch_2012 <- c(rep('bf', 5), 'launch', rep('af', 7))
newdata <- data.frame(amount = jp_total_2012, one_week_bf = jp_one_week_bf_2012, two_week_bf = jp_two_week_bf_2012, launch = launch_2012, week = week)
View(newdata)
predict(model0, newdata)
predict(model0, newdata, interval='predict')
