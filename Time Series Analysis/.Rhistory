d <- jp_2011_data
amount <- d$x
one_week_bf <- d$y
launch <- d$z
week <- 1:13
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:12) {
predicted <- predict(model1, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
jp_2011_fc_a <- fit1(jp_2011_data, amount, one_week_bf, launch)
fit1 <- function(d, x, y, z) {
d <- jp_2011_data
amount <- d[x]
one_week_bf <- d[y]
launch <- d[z]
week <- 1:13
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:12) {
predicted <- predict(model1, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
jp_2011_fc_a <- fit1(jp_2011_data, amount, one_week_bf, launch)
fit1 <- function(d, x, y, z) {
d <- jp_2011_data
amount <- d['x']
one_week_bf <- d['y']
launch <- d['z']
week <- 1:13
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:12) {
predicted <- predict(model1, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
jp_2011_fc_a <- fit1(jp_2011_data, amount, one_week_bf, launch)
fit1 <- function(d, x, y, z) {
d <- jp_2011_data
amount <- d[, 'x']
one_week_bf <- d[, 'y']
launch <- d[, 'z']
week <- 1:13
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:12) {
predicted <- predict(model1, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
jp_2011_fc_a <- fit1(jp_2011_data, amount, one_week_bf, launch)
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
week <- 1:13
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:12) {
predicted <- predict(model1, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
jp_2011_fc_a <- fit1(jp_2011_data$amount, jp_2011_data$one_week_bf, jp_2011_data$launch)
View(jp_2011_fc_a)
jp_s_2012 <- c(2394, 2027, 1824, 1642, 1593, NA, NA, NA, NA, NA, NA, NA, NA)
jp_s_1wbf_2012 <- c(NA, 2394, 2027, 1824, 1642, 1593, NA, NA, NA, NA, NA, NA, NA)
jp_s_2wbf_2012 <- c(NA, NA, 2394, 2027, 1824, 1642, 1593, NA, NA, NA, NA, NA, NA)
jp_s_2012_data <- data.frame(amount = jp_s_2012, one_week_bf = jp_s_1wbf_2012, two_week_bf = jp_s_2wbf_2012, week = week, launch = launch_2012)
View(jp_s_2012_data)
jp_p_2012 <- c(1645, 1403, 1263, 1136, 1102, NA, NA, NA, NA, NA, NA, NA, NA)
jp_p_1wbf_2012 <- c(NA, 1645, 1403, 1263, 1136, 1102, NA, NA, NA, NA, NA, NA, NA)
jp_p_2wbf_2012 <- c(NA, NA, 1645, 1403, 1263, 1136, 1102, NA, NA, NA, NA, NA, NA)
jp_p_2012_data <- data.frame(amount = jp_p_2012, one_week_bf = jp_p_1wbf_2012, two_week_bf = jp_p_2wbf_2012, week = week, launch = launch_2012)
View(jp_p_2012_data)
jp_r_2012 <- c(679, 567, 510, 459, 445, NA, NA, NA, NA, NA, NA, NA, NA)
jp_r_1wbf_2012 <- c(NA, 679, 567, 510, 459, 445, NA, NA, NA, NA, NA, NA, NA)
jp_r_2wbf_2012 <- c(NA, NA, 679, 567, 510, 459, 445, NA, NA, NA, NA, NA, NA)
jp_r_2012_data <- data.frame(amount = jp_r_2012, one_week_bf = jp_r_1wbf_2012, two_week_bf = jp_r_2wbf_2012, week = week, launch = launch_2012)
View(jp_r_2012_data)
jp_g_2012 <- c(1285, 1042, 937, 844, 819, NA, NA, NA, NA, NA, NA, NA, NA)
jp_g_1wbf_2012 <- c(NA, 1285, 1042, 937, 844, 819, NA, NA, NA, NA, NA, NA, NA)
jp_g_2wbf_2012 <- c(NA, NA, 1285, 1042, 937, 844, 819, NA, NA, NA, NA, NA, NA)
jp_g_2012_data <- data.frame(amount = jp_g_2012, one_week_bf = jp_g_1wbf_2012, two_week_bf = jp_g_2wbf_2012, week = week, launch = launch_2012)
View(jp_g_2012_data)
jp_b_2012 <- c(1943, 1602, 1441, 1297, 1258, NA, NA, NA, NA, NA, NA, NA, NA)
jp_b_1wbf_2012 <- c(NA, 1943, 1602, 1441, 1297, 1258, NA, NA, NA, NA, NA, NA, NA)
jp_b_2wbf_2012 <- c(NA, NA, 1943, 1602, 1441, 1297, 1258, NA, NA, NA, NA, NA, NA)
jp_b_2012_data <- data.frame(amount = jp_b_2012, one_week_bf = jp_b_1wbf_2012, two_week_bf = jp_b_2wbf_2012, week = week, launch = launch_2012)
View(jp_b_2012_data)
jp_s_2012_fc_a <- fit1(jp_s_2012_data$amount, jp_s_2012_data$one_week_bf, jp_s_2012_data$launch)
View(jp_s_2012_fc_a)
jp_s_2012_fc_b <- fit2(jp_s_2012_data$amount, jp_s_2012_data$one_week_bf, jp_s_2012_data$two_week_bf, jp_s_2012_data$launch)
View(jp_s_2012_fc_b)
plot(jp_s_2012_data$amount ~ jp_s_2012_data$week, col = "red", pch = 20, ylim = c(5000, 15000))
plot(jp_s_2012_data$amount ~ jp_s_2012_data$week, col = "red", pch = 20, ylim = c(2000, 15000))
plot(jp_s_2012_data$amount ~ jp_s_2012_data$week, col = "red", pch = 20, ylim = c(2000, 8000))
plot(jp_s_2012_data$amount ~ jp_s_2012_data$week, col = "red", pch = 20, ylim = c(1000, 8000))
lines(1:13, jp_s_2012_fc_a$amount, col = 'green')
lines(1:13, jp_s_2012_fc_b$amount, col = 'blue')
View(jp_s_2012_fc_a)
jp_2012_fc_a <- fit1(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$launch)
View(jp_2012_fc_a)
jp_s_2012_fc_b <- fit2(jp_s_2012_data$amount, jp_s_2012_data$one_week_bf, jp_s_2012_data$two_week_bf, jp_s_2012_data$launch)
View(jp_s_2012_fc_b)
jp_2011_fc_a <- fit1(jp_2011_data$amount, jp_2011_data$one_week_bf, jp_2011_data$launch)
View(jp_2011_fc_a)
jp_2011_fc_b <- fit2(jp_2011_data$amount, jp_2011_data$one_week_bf, jp_2011_data$two_week_bf, jp_2011_data$launch)
View(jp_2011_fc_b)
jp_2012_fc_a <- fit1(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$launch)
View(jp_2012_fc_a)
jp_2012_fc_b <- fit2(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$two_week_bf, jp_2012_data$launch)
View(jp_2012_fc_b)
jp_s_2012_fc_a <- fit1(jp_s_2012_data$amount, jp_s_2012_data$one_week_bf, jp_s_2012_data$launch)
View(jp_s_2012_fc_a)
jp_s_2012_fc_b <- fit2(jp_s_2012_data$amount, jp_s_2012_data$one_week_bf, jp_s_2012_data$two_week_bf, jp_s_2012_data$launch)
View(jp_s_2012_fc_b)
model1b <- lm(amount ~ launch + one_week_bf + two_week_bf, data = jp_2011_data)
summary(model1b)
jp_2011_fc_a <- fit1(jp_2011_data$amount, jp_2011_data$one_week_bf, jp_2011_data$launch)
jp_2011_fc_b <- fit2(jp_2011_data$amount, jp_2011_data$one_week_bf, jp_2011_data$two_week_bf, jp_2011_data$launch)
plot(jp_2011_data$amount ~ jp_2011_data$week, col = "red", pch = 20)
lines(1:13, jp_2011_fc_a$amount, col = 'green')
lines(1:13, jp_2011_fc_b$amount, col = 'blue')
jp_2012_fc_a <- fit1(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$launch)
jp_2012_fc_b <- fit2(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$two_week_bf, jp_2012_data$launch)
plot(jp_2012_data$amount ~ jp_2012_data$week, col = "red", pch = 20, ylim = c(5000, 15000))
lines(1:13, jp_2012_fc_a$amount, col = 'green')
lines(1:13, jp_2012_fc_b$amount, col = 'blue')
plot(jp_s_2012_data$amount ~ jp_s_2012_data$week, col = "red", pch = 20, ylim = c(1000, 8000))
lines(1:13, jp_s_2012_fc_a$amount, col = 'green')
lines(1:13, jp_s_2012_fc_b$amount, col = 'blue')
plot(jp_s_2012_data$amount ~ jp_s_2012_data$week, col = "red", pch = 20, ylim = c(1000, 15000))
lines(1:13, jp_s_2012_fc_a$amount, col = 'green')
lines(1:13, jp_s_2012_fc_b$amount, col = 'blue')
launch_2011 <- c(rep('bf', 2),'launch0', 'launch', 'launch2', rep('af',9))
launch_2011 <- c(rep('bf', 2),'launch0', 'launch', 'launch2', rep('af', 8))
jp_2011_data <- data.frame(amount = jp_total_2011, one_week_bf = jp_total_1wbf_2011, two_week_bf = jp_total_2wbf_2011, week = week, launch = launch_2011)
summary(model1)
plot(model1)
model1b <- lm(amount ~ launch + one_week_bf + two_week_bf, data = jp_2011_data)
summary(model1b)
jp_2011_fc_a <- fit1(jp_2011_data$amount, jp_2011_data$one_week_bf, jp_2011_data$launch)
View(jp_2011_fc_a)
launch_2012 <- c(rep('bf',4), 'launch0', 'launch', 'launch2', rep('af',7))
jp_2012_data <- data.frame(amount = jp_total_2012, one_week_bf = jp_total_1wbf_2012, two_week_bf = jp_total_2wbf_2012, week = week, launch = launch_2012)
launch_2012 <- c(rep('bf',4), 'launch0', 'launch', 'launch2', rep('af',6))
jp_2012_data <- data.frame(amount = jp_total_2012, one_week_bf = jp_total_1wbf_2012, two_week_bf = jp_total_2wbf_2012, week = week, launch = launch_2012)
View(jp_2012_data)
plot(jp_2011_data$amount ~ jp_2011_data$week, col = "red", pch = 20)
lines(1:13, jp_2011_fc_a$amount, col = 'green')
lines(1:13, jp_2011_fc_b$amount, col = 'blue')
jp_2012_fc_a <- fit1(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$launch)
launch_2012 <- c(rep('bf',4), 'launch0', 'launch', 'launch2', rep('af',6))
jp_total_2012 <- c(7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA, NA, NA)
jp_total_1wbf_2012 <- c(NA, 7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA, NA)
jp_total_2wbf_2012 <- c(NA, NA, 7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA)
jp_2012_data <- data.frame(amount = jp_total_2012, one_week_bf = jp_total_1wbf_2012, two_week_bf = jp_total_2wbf_2012, week = week, launch = launch_2012)
View(jp_2012_data)
jp_2012_fc_a <- fit1(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$launch)
jp_2011_fc_a <- fit1(jp_2011_data$amount, jp_2011_data$one_week_bf, jp_2011_data$launch)
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
week <- 1:13
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:12) {
predicted <- predict(model1, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
fit2 <- function(x, y, z, a) {
amount <- x
one_week_bf <- y
two_week_bf <- z
launch <- a
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, two_week_bf = two_week_bf, launch = launch, week = week)
for (i in 1:11) {
predicted <- predict(model1b, newdata)
newdata$amount[i+2] <- predicted[i+2]
try(newdata$one_week_bf[i+3] <- predicted[i+2])
try(newdata$two_week_bf[i+4] <- predicted[i+2])
}
return(newdata)
}
jp_2011_data$launch
jp_2011_fc_a <- fit1(jp_2011_data$amount, jp_2011_data$one_week_bf, jp_2011_data$launch)
View(jp_2011_fc_a)
launch_2012 <- c(rep('bf',5), 'launch', rep('af',7))
jp_2012_data <- data.frame(amount = jp_total_2012, one_week_bf = jp_total_1wbf_2012, two_week_bf = jp_total_2wbf_2012, week = week, launch = launch_2012)
launch_2011 <- c(rep('bf', 3), 'launch', rep('af', 9))
jp_2011_data <- data.frame(amount = jp_total_2011, one_week_bf = jp_total_1wbf_2011, two_week_bf = jp_total_2wbf_2011, week = week, launch = launch_2011)
jp_2011_fc_a <- fit1(jp_2011_data$amount, jp_2011_data$one_week_bf, jp_2011_data$launch)
View(jp_2011_fc_a)
jp_2012_fc_a <- fit1(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$launch)
jp_2012_fc_b <- fit2(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$two_week_bf, jp_2012_data$launch)
plot(jp_2012_data$amount ~ jp_2012_data$week, col = "red", pch = 20, ylim = c(5000, 15000))
lines(1:13, jp_2012_fc_a$amount, col = 'green')
lines(1:13, jp_2012_fc_b$amount, col = 'blue')
jp_2012_fc_b <- fit2(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$two_week_bf, jp_2012_data$launch)
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
week <- 1:13
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:12) {
predicted <- predict(model1, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
jp_2012_fc_a <- fit1(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$launch)
jp_2012_fc_b <- fit2(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$two_week_bf, jp_2012_data$launch)
jp_s_2012_fc_a <- fit1(jp_s_2012_data$amount, jp_s_2012_data$one_week_bf, jp_s_2012_data$launch)
View(jp_s_2012_fc_a)
jp_s_2012_fc_b <- fit2(jp_s_2012_data$amount, jp_s_2012_data$one_week_bf, jp_s_2012_data$two_week_bf, jp_s_2012_data$launch)
View(jp_s_2012_fc_b)
jp_2012_fc_a <- fit1(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$launch)
jp_2012_fc_b <- fit2(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$two_week_bf, jp_2012_data$launch)
summary(model1)
model1b <- lm(amount ~ launch + one_week_bf + two_week_bf, data = jp_2011_data)
jp_2011_fc_a <- fit1(jp_2011_data$amount, jp_2011_data$one_week_bf, jp_2011_data$launch)
jp_2011_fc_b <- fit2(jp_2011_data$amount, jp_2011_data$one_week_bf, jp_2011_data$two_week_bf, jp_2011_data$launch)
jp_2012_fc_a <- fit1(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$launch)
jp_2012_fc_b <- fit2(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$two_week_bf, jp_2012_data$launch)
plot(jp_2012_data$amount ~ jp_2012_data$week, col = "red", pch = 20, ylim = c(5000, 15000))
lines(1:13, jp_2012_fc_a$amount, col = 'green')
lines(1:13, jp_2012_fc_b$amount, col = 'blue')
launch_2011 <- -3:9
sa_2011_data <- data.frame(amount = sa_total_2011, one_week_bf = sa_total_1wbf_2011, two_week_bf = sa_total_2wbf_2011, week = week, launch = launch_2011)
launch_2011 <- -3:9
jp_2011_data <- data.frame(amount = jp_total_2011, one_week_bf = jp_total_1wbf_2011, two_week_bf = jp_total_2wbf_2011, week = week, launch = launch_2011)
View(jp_2011_data)
summary(model1)
plot(model1)
jp_2011_data <- data.frame(amount = jp_total_2011, one_week_bf = jp_total_1wbf_2011, two_week_bf = jp_total_2wbf_2011, week = week, launch = launch_2011)
View(jp_2011_data)
model1 <- lm(amount ~ launch + one_week_bf, data = jp_2011_data)
summary(model1)
launch_2011 <- c(rep('bf',3), 'launch', rep('af',9))
countdown <- -3:9
jp_2011_data <- data.frame(amount = jp_total_2011, one_week_bf = jp_total_1wbf_2011, two_week_bf = jp_total_2wbf_2011, week = week, launch = launch_2011, count = countdown)
model1 <- lm(amount ~ launch + one_week_bf + count, data = jp_2011_data)
summary(model1)
model1b <- lm(amount ~ launch + one_week_bf + two_week_bf + count, data = jp_2011_data)
summary(model1b)
plot(jp_2011_data$amount ~ jp_2011_data$week, col = "red", lwd = 1.5, pch = 20, xlab = "Weeks in 2011 3Q", ylab = "Sales")
lines(2:13, model1$fitted, col="blue", lwd = 2)
lines(3:13, model1b$fitted, col="cyan", lwd = 2)
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
week <- 1:13
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:12) {
predicted <- predict(model1, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
jp_2011_fc_a <- fit1(jp_2011_data$amount, jp_2011_data$one_week_bf, jp_2011_data$launch)
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
week <- 1:13
count <- -3:9
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week, count = count)
for (i in 1:12) {
predicted <- predict(model1, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
jp_2011_fc_a <- fit1(jp_2011_data$amount, jp_2011_data$one_week_bf, jp_2011_data$launch)
View(jp_2011_fc_a)
plot(jp_2011_data$amount ~ jp_2011_data$week, col = "red", pch = 20)
lines(1:13, jp_2011_fc_a$amount, col = 'green')
jp_2012_fc_a <- fit1(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$launch)
View(jp_2012_fc_a)
plot(jp_2012_data$amount ~ jp_2012_data$week, col = "red", pch = 20, ylim = c(5000, 15000))
lines(1:13, jp_2012_fc_a$amount, col = 'green')
plot(jp_2012_data$amount ~ jp_2012_data$week, col = "red", pch = 20, ylim = c(1000, 15000))
lines(1:13, jp_2012_fc_a$amount, col = 'green')
View(jp_2012_fc_b)
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
week <- 1:13
count <- -3:9
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week, count = count)
for (i in 1:12) {
predicted <- predict(model1, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
jp_2011_fc_a <- fit1(jp_2011_data$amount, jp_2011_data$one_week_bf, jp_2011_data$launch)
View(jp_2011_fc_a)
jp_2012_fc_a <- fit1(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$launch)
View(jp_2012_fc_a)
jp_s_2012_fc_a <- fit1(jp_s_2012_data$amount, jp_s_2012_data$one_week_bf, jp_s_2012_data$launch)
View(jp_s_2012_fc_a)
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
week <- 1:13
count <- -5:7
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week, count = count)
for (i in 1:12) {
predicted <- predict(model1, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
jp_2012_fc_a <- fit1(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$launch)
plot(jp_2012_data$amount ~ jp_2012_data$week, col = "red", pch = 20, ylim = c(1000, 15000))
lines(1:13, jp_2012_fc_a$amount, col = 'green')
jp_s_2012_fc_a <- fit1(jp_s_2012_data$amount, jp_s_2012_data$one_week_bf, jp_s_2012_data$launch)
View(jp_s_2012_fc_a)
plot(jp_s_2012_data$amount ~ jp_s_2012_data$week, col = "red", pch = 20, ylim = c(1000, 15000))
lines(1:13, jp_s_2012_fc_a$amount, col = 'green')
View(jp_s_2012_fc_a)
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
week <- 1:13
count <- -3:9
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week, count = count)
for (i in 1:12) {
predicted <- predict(model1, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
jp_2011_fc_a <- fit1(jp_2011_data$amount, jp_2011_data$one_week_bf, jp_2011_data$launch)
plot(jp_2011_data$amount ~ jp_2011_data$week, col = "red", pch = 20)
lines(1:13, jp_2011_fc_a$amount, col = 'green')
jp_2012_fc_a <- fit1(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$launch)
View(jp_2012_fc_a)
plot(jp_2012_data$amount ~ jp_2012_data$week, col = "red", pch = 20, ylim = c(1000, 15000))
lines(1:13, jp_2012_fc_a$amount, col = 'green')
jp_s_2012_fc_a <- fit1(jp_s_2012_data$amount, jp_s_2012_data$one_week_bf, jp_s_2012_data$launch)
plot(jp_s_2012_data$amount ~ jp_s_2012_data$week, col = "red", pch = 20, ylim = c(1000, 15000))
lines(1:13, jp_s_2012_fc_a$amount, col = 'green')
View(jp_s_2012_fc_a)
View(jp_2012_fc_a)
View(jp_s_2012_fc_a)
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
week <- 1:13
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:12) {
predicted <- predict(model1c, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
jp_2012_fc_a <- fit1(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$launch)
View(jp_2012_fc_a)
plot(jp_2012_data$amount ~ jp_2012_data$week, col = "red", pch = 20, ylim = c(1000, 15000))
lines(1:13, jp_2012_fc_a$amount, col = 'green')
View(jp_2012_fc_a)
jp_s_2012_fc_a <- fit1(jp_s_2012_data$amount, jp_s_2012_data$one_week_bf, jp_s_2012_data$launch)
plot(jp_s_2012_data$amount ~ jp_s_2012_data$week, col = "red", pch = 20, ylim = c(1000, 15000))
lines(1:13, jp_s_2012_fc_a$amount, col = 'green')
model1 <- lm(amount ~ launch + one_week_bf + count, data = jp_2011_data)
summary(model1)
model2 <- lm(amount ~ launch + I(one_week_bf^2), data = jp_2011_data)
summary(model2)
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
week <- 1:13
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:12) {
predicted <- predict(model2, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
jp_2011_fc_a <- fit1(jp_2011_data$amount, jp_2011_data$one_week_bf, jp_2011_data$launch)
plot(jp_2011_data$amount ~ jp_2011_data$week, col = "red", pch = 20)
lines(1:13, jp_2011_fc_a$amount, col = 'green')
jp_2012_fc_a <- fit1(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$launch)
plot(jp_2012_data$amount ~ jp_2012_data$week, col = "red", pch = 20, ylim = c(1000, 15000))
lines(1:13, jp_2012_fc_a$amount, col = 'green')
jp_s_2012_fc_a <- fit1(jp_s_2012_data$amount, jp_s_2012_data$one_week_bf, jp_s_2012_data$launch)
plot(jp_s_2012_data$amount ~ jp_s_2012_data$week, col = "red", pch = 20, ylim = c(1000, 15000))
lines(1:13, jp_s_2012_fc_a$amount, col = 'green')
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
week <- 1:13
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:12) {
predicted <- predict(model2, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
jp_s_2012_fc_a <- fit1(jp_s_2012_data$amount, jp_s_2012_data$one_week_bf, jp_s_2012_data$launch)
View(jp_s_2012_fc_a)
predicted <- predict(model1, newdata)
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
week <- 1:13
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:12) {
predicted <- predict(model1, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
jp_2011_fc_a <- fit1(jp_2011_data$amount, jp_2011_data$one_week_bf, jp_2011_data$launch)
model1 <- lm(amount ~ launch + one_week_bf + count, data = jp_2011_data)
summary(model1)
countdown <- factor(-3:9)
countdown
jp_2011_data <- data.frame(amount = jp_total_2011, one_week_bf = jp_total_1wbf_2011, two_week_bf = jp_total_2wbf_2011, week = week, launch = launch_2011, count = countdown)
countdown <- factor(-5:7)
countdown_2012 <- factor(-3:9)
countdown_2012 <- factor(-5:7)
jp_2012_data <- data.frame(amount = jp_total_2012, one_week_bf = jp_total_1wbf_2012, two_week_bf = jp_total_2wbf_2012, week = week, launch = launch_2012, count = countdown_2012)
View(jp_2012_data)
model1 <- lm(amount ~ launch + one_week_bf + count, data = jp_2011_data)
summary(model1)
model1 <- lm(amount ~ launch + one_week_bf, data = jp_2011_data)
summary(model1)
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
week <- 1:13
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:12) {
predicted <- predict(model1, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
jp_s_2012_fc_a <- fit1(jp_s_2012_data$amount, jp_s_2012_data$one_week_bf, jp_s_2012_data$launch)
View(jp_s_2012_fc_a)
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
week <- 1:13
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 5:13) {
predicted <- predict(model1, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
jp_2012_fc_a <- fit1(jp_2012_data$amount, jp_2012_data$one_week_bf, jp_2012_data$launch)
View(jp_2012_fc_a)
plot(jp_2012_data$amount ~ jp_2012_data$week, col = "red", pch = 20, ylim = c(1000, 15000))
lines(5:13, jp_2012_fc_a$amount, col = 'green')
lines(6:13, jp_2012_fc_a$amount, col = 'green')
lines(1:13, jp_2012_fc_a$amount, col = 'green')
jp_s_2012_fc_a <- fit1(jp_s_2012_data$amount, jp_s_2012_data$one_week_bf, jp_s_2012_data$launch)
plot(jp_s_2012_data$amount ~ jp_s_2012_data$week, col = "red", pch = 20, ylim = c(1000, 15000))
lines(1:13, jp_s_2012_fc_a$amount, col = 'green')
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
week <- 1:13
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:13) {
predicted <- predict(model1, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
