<<<<<<< HEAD
predict(fit1,data.frame(lstat=c(5,10,15)),interval="confidence")
### Multiple linear regression
fit2=lm(medv~lstat+age,data=Boston)
summary(fit2)
fit3=lm(medv~.,Boston)
summary(fit3)
par(mfrow=c(2,2))
plot(fit3)
fit4=update(fit3,~.-age-indus)
summary(fit4)
### Nonlinear terms and Interactions
fit5=lm(medv~lstat*age,Boston)
summary(fit5)
fit6=lm(medv~lstat +I(lstat^2),Boston); summary(fit6)
attach(Boston)
par(mfrow=c(1,1))
plot(medv~lstat)
points(lstat,fitted(fit6),col="red",pch=20)
attach(japan_2011)
points(one_week_bf,fitted(model01), data = japan_2011, col="blue",pch=20)
plot(medv~lstat)
points(lstat,fitted(fit6),col="red",pch=20)
plot(japan_2011$amt ~ japan_2011$week)
points(one_week_bf,fitted(model01), col="blue",pch=20)
View(japan_2011$one_week_bf)
points(amt,fitted(model01), col="blue",pch=20)
plot(japan_2011$amt ~ japan_2011$week)
points(amt,fitted(model01), col="blue",pch=20)
plot(medv~lstat)
points(lstat,fitted(fit6),col="red",pch=20)
points(week,fitted(model01), col="blue",pch=20)
fit7=lm(medv~poly(lstat,4))
points(lstat,fitted(fit7),col="blue",pch=20)
?points
plot(japan_2011$amt ~ japan_2011$week)
points(week, fitted(model01), col="blue",pch=20)
points(japans_2011$week, fitted(model01), col="blue",pch=20)
points(japan_2011$week, fitted(model01), col="blue",pch=20)
?points
plot(medv~lstat)
points(lstat,fitted(fit6),col="red",pch=20)
fit7=lm(medv~poly(lstat,4))
points(lstat,fitted(fit7),col="blue",pch=20)
points(japan_2011$year, fitted(model01), col="blue",pch=20)
plot(japan_2011$amt ~ japan_2011$week)
points(japan_2011$amt, fitted(model01), col="blue",pch=20)
model01$fitted
points(japan_2011$amt, model01$fitted, col="blue",pch=20)
points(japan_2011$week, model01$fitted, col="blue",pch=20)
model01$fitted
japan_2011$week
length(model01$fitted)
length(japan_2011$week)
points(2:12, model01$fitted, col="blue",pch=20)
points(2:13, model01$fitted, col="blue",pch=20)
plot(japan_2011$amt ~ japan_2011$week, col = "red")
points(2:13, model01$fitted, col="blue",pch=20)
plot(japan_2011$amt ~ japan_2011$week, col = "red", pch=20)
points(2:13, model01$fitted, col="blue",pch=20)
plot(model01)
plot(japan_2011$amt ~ japan_2011$week, col = "red", pch=20)
points(2:13, model01$fitted, col="blue",pch=20)
points(2:13, model02$fitted, col="green",pch=20)
points(2:13, model02$fitted, col="green",pch=20)
points(3:13, model02$fitted, col="green",pch=20)
# week before values squared
plot(japan_2011$amt ~ japan_2011$week, col = "red")
points(2:13, model01$fitted, col="blue")
points(3:13, model02$fitted, col="green")
model01 <- lm(amt ~ launch + I(one_week_bf^2), data = japan_2011)
model02 <- lm(amt ~ launch + I(one_week_bf^2) + I(two_week_bf^2), data = japan_2011)
summary(model01)
summary(model02)
plot(model01)
plot(model02)
gas  <- read.xlsx(xl_file, sheetIndex = 1, colIndex = colI, rowIndex = rowI)
colI <- 3:16
rowI <- 26
xl_file <- 'iShades APAC v1.1.xlsx'
gas  <- read.xlsx(xl_file, sheetIndex = 1, colIndex = colI, rowIndex = rowI)
warnings()
xl_file <- 'iShades APAC v1.1.xlsx'
gas  <- read.xlsx(xl_file, sheetIndex = 1, colIndex = colI, rowIndex = rowI)
getwd()
gas  <- read.xlsx(xl_file, colIndex = colI, rowIndex = rowI)
?read.xlsx
gas  <- read.xlsx(xl_file, sheetName = 'Case', colIndex = colI, rowIndex = rowI)
gas  <- read.xlsx(xl_file, sheetName = Case, colIndex = colI, rowIndex = rowI)
xl_file <- 'iShades APAC v1.1.xlsx'
gas  <- read.xlsx(xl_file, sheetName = 'Case', colIndex = colI, rowIndex = rowI)
rowI <- 17
xl_file <- 'iShades APAC v1.1.xlsx'
gas  <- read.xlsx(xl_file, sheetName = 'Case', colIndex = colI, rowIndex = rowI)
colI <- 1:16
rowI <- 17
xl_file <- 'iShades APAC v1.1.xlsx'
gas  <- read.xlsx(xl_file, sheetName = 'Case', colIndex = colI, rowIndex = rowI)
sa_total_2011 <- c(2375, 2172, 2033, 4573, 5545, 4436, 3549, 3371, 3203, 3042, 2982, 3041, 3072)
nz_total_2011 <- c(3700, 3333, 3119, 7018, 8509, 6807, 5446, 5173, 4915, 4669, 4576, 4667, 4714)
japan_total_2011n <- scale(japan_total_2011)
View(japan_total_2011n)
japan_total_2011n <- scale(japan_total_2011)
sa_total_2011n <- scale(sa_total_2011)
nz_total_2011n <- scale(nz_total_2011)
plot(japan_total_2011n ~ 1:13)
weeks <- 1:13
plot(japan_total_2011n ~ weeks)
points(sa_total_2011n ~ weeks)
points(nz_total_2011n ~ weeks)
plot(japan_total_2011n ~ weeks, color = "red", pch = 20)
plot(japan_total_2011n ~ weeks, colour = "red", pch = 20)
plot(japan_total_2011n ~ weeks, col= "red", pch = 20)
points(nz_total_2011n ~ weeks, col="green", pch=20)
points(sa_total_2011n ~ weeks, col="blue", pch = 20)
japan_total_2011n <- scale(japan_total_2011)
sa_total_2011n <- scale(sa_total_2011)
nz_total_2011n <- scale(nz_total_2011)
weeks <- 1:13
plot(japan_total_2011n ~ weeks, col="red", pch = 20)
points(sa_total_2011n ~ weeks, col="blue", pch = 20)
points(nz_total_2011n ~ weeks, col="green", pch=20)
?cor
cor(japan_total_2011n, sa_total_2011n)
total_2011n <- data.frame(jp = japan_total_2011n, sa = sa_total_2011n, nz = nz_total_2011n)
cor(total_2011n)
total_2011n <- data.frame(jp = japan_total_2011n, sa = sa_total_2011n, nz = nz_total_2011n)
plot(japan_total_2011n ~ weeks, col="red", pch = 20, type = "l")
lines(sa_total_2011n ~ weeks, col="blue", pch = 20)
lines(nz_total_2011n ~ weeks, col="green", pch=20)
legend ('topright', c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
legend (2000, 9.5, c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
legend (2000, 9.5, c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
plot(japan_total_2011n ~ weeks, col="red", pch = 20, type = "l")
lines(sa_total_2011n ~ weeks, col="blue", pch = 20)
lines(nz_total_2011n ~ weeks, col="green", pch=20)
legend (2000, 9.5, c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
legend (10, 9.5, c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
legend (10, 10, c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
legend (100, 10, c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
legend(100, 100, c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
?legend
legend(x = 100, y = 100, c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
legend('topright', c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
xlab = "Weeks in 2011 3Q"
plot(japan_total_2011n ~ weeks, col="red", pch = 20, type = "l", xlab = "Weeks in 2011 3Q")
plot(japan_total_2011n ~ weeks, col="red", pch = 20, type = "l", xlab = "Weeks in 2011 3Q", ylab = 'Sales(normalized)')
plot(japan_total_2011n ~ weeks, col="red", pch = 20, type = "l", xlab = "Weeks in 2011 3Q", ylab = 'Sales (normalized)')
lines(sa_total_2011n ~ weeks, col="blue", pch = 20)
lines(nz_total_2011n ~ weeks, col="green", pch=20)
legend('topright', c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
plot(japan_total_2011n ~ weeks, col="red", pch = 20, type = "l", main = "Plot of sales in JP, SA & NZ in 2011 3Q", xlab = "Weeks in 2011 3Q", ylab = 'Sales (normalized)')
plot(japan_total_2011n ~ weeks, col="red", pch = 20, type = "l", main = "Plot of iShades sales in JP, SA & NZ in 2011 3Q", xlab = "Weeks in 2011 3Q", ylab = 'Sales (normalized)')
lines(sa_total_2011n ~ weeks, col="blue", pch = 20)
lines(nz_total_2011n ~ weeks, col="green", pch=20)
legend('topright', c("Japan", "South Asia", "New Zealand"), lty=1, lwd=2.5, col=c("red", "blue", "green"))
weeks <- c(1:13, 3)
weeks <- c(rep(1:13, 3)
weeks <- c(rep(1:13, 3))
weeks <- c(rep(1:13, 3))
weeks
country <- c(rep('JP', 13), rep('SA', 13), rep('NZ', 13))
country
total_2011n <- data.frame(jp = jp_total_2011n, sa = sa_total_2011n, nz = nz_total_2011n)
jp_total_2011n <- scale(jp_total_2011)
jp_total_2011 <- c(5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648, 6597, 6795, 6659)
sa_total_2011 <- c(2375, 2172, 2033, 4573, 5545, 4436, 3549, 3371, 3203, 3042, 2982, 3041, 3072)
nz_total_2011 <- c(3700, 3333, 3119, 7018, 8509, 6807, 5446, 5173, 4915, 4669, 4576, 4667, 4714)
cor(jp_total_2011n)
jp_total_2011n <- scale(jp_total_2011)
sa_total_2011n <- scale(sa_total_2011)
nz_total_2011n <- scale(nz_total_2011)
total_2011n <- data.frame(jp = jp_total_2011n, sa = sa_total_2011n, nz = nz_total_2011n)
# correlation check
cor(jp_total_2011n)
cor(total_2011n)
sa_one_week_bf_2011 <- c(NA, 2375, 2172, 2033, 4573, 5545, 4436, 3549, 3371, 3203, 3042, 2982, 3041)
jp_one_week_bf_2011 <- c(NA, 5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648, 6597, 6795)
jp_two_week_bf_2011 <- c(NA, NA, 5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648, 6597)
sa_one_week_bf_2011 <- c(NA, 2375, 2172, 2033, 4573, 5545, 4436, 3549, 3371, 3203, 3042, 2982, 3041)
sa_two_week_bf_2011 <- c(NA, NA, 2375, 2172, 2033, 4573, 5545, 4436, 3549, 3371, 3203, 3042, 2982)
nz_one_week_bf_2011 <- c(NA, 3700, 3333, 3119, 7018, 8509, 6807, 5446, 5173, 4915, 4669, 4576, 4667)
nz_two_week_bf_2011 <- c(NA, NA, 3700, 3333, 3119, 7018, 8509, 6807, 5446, 5173, 4915, 4669, 4576)
one_week_bf_2011 <- c(jp_one_week_bf_2011, sa_one_week_bf_2011, nz_one_week_bf_2011)
two_week_bf_2011 <- c(jp_two_week_bf_2011, sa_two_week_bf_2011, nz_two_week_bf_2011)
total_2011 <- c(jp_total_2011, sa_total_2011, nz_total_2011)
launch <- c(rep(rep('bf',3), 'launch', rep('af',9)), 3)
launch <- c(rep(rep('bf',3), 'launch', rep('af',9), 3)
launch <- c(rep(rep('bf',3), 'launch', rep('af',9), 3))
launch <- c(rep(rep('bf',3), 'launch', rep('af',9), 3))
launch <- c(rep(rep('bf',3), 'launch', rep('af',9)), 3)
launch
launch <- c(rep('bf',3), 'launch', rep('af',9))
launch
launch <- c(rep(rep('bf',3), 'launch', rep('af',9), 3)
launch <- c(rep(rep('bf',3), 'launch', rep('af',9), 3))
launch <- c(rep('bf',3), 'launch', rep('af',9), 3)
launch
launch <- c(rep((c(rep('bf',3), 'launch', rep('af',9), 3)), 3))
launch
launch <- c(rep((c(rep('bf',3), 'launch', rep('af',9), 3))))
launch
launch <- c(rep('bf',3), 'launch', rep('af',9), 3)
launch
launch <- c(rep('bf',3), 'launch', rep('af',9))
launch
launch <- c(rep((c(rep('bf',3), 'launch', rep('af',9))),3)
launch
launch <- c(rep((c(rep('bf',3), 'launch', rep('af',9))),3))
launch
total_2011n <- data.frame(amount = total_2011, one_week_bf = one_week_bf_2011, two_week_bf = two_week_bf_2011, country = country, weeks = weeks, launch = launch)
total_2011 <- data.frame(amount = total_2011, one_week_bf = one_week_bf_2011, two_week_bf = two_week_bf_2011, country = country, weeks = weeks, launch = launch)
rm('total_2011')
View(total_2011)
rm(list = ls())
total_2011 <- data.frame(amount = total_2011, one_week_bf = one_week_bf_2011, two_week_bf = two_week_bf_2011, country = country, weeks = weeks, launch = launch)
View(total_2011)
data_2011 <- data.frame(amount = total_2011, one_week_bf = one_week_bf_2011, two_week_bf = two_week_bf_2011, country = country, weeks = weeks, launch = launch)
=======
for (i in 1:8) {
predicted <- predict(model0a, newdata)
newdata$amount[i+5] <- predicted[i+5]
try(newdata$one_week_bf[i+6] <- predicted[i+5])
}
return(newdata)
newdata2 <- newdata
}
fit(jp_total_2012a, jp_one_week_bf_2012a)
View(newdata2)
newdata2 <- fit(jp_total_2012a, jp_one_week_bf_2012a)
View(newdata2)
lines(1:13, newdata2$amount, col = 'green')
plot(jp_2011$amount ~ jp_2011$week, col = "red", pch = 20)
lines(3:13, model0$fitted, col="blue")
lines(2:13, model0a$fitted, col="orange")
>>>>>>> 700065015c0a0e42a6b74789294dba5aaa5f5671
jp_total_2011 <- c(5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648, 6597, 6795, 6659)
jp_one_week_bf_2011 <- c(NA, 5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648, 6597, 6795)
newdata3 <- fit(jp_total_2011, jp_one_week_bf_2011)
View(newdata2)
View(newdata3)
lines(1:13, newdata3$amount, col = 'green')
plot(jp_2011$amount ~ jp_2011$week, col = "red", pch = 20)
lines(1:13, predict(model0, newdata), col='green')
lines(1:13, predict(model0a, newdata), col='orange')
model0 <- lm(amount ~ launch + one_week_bf + two_week_bf, data = jp_2011)
summary(model0)
model0a <- lm(amount ~ launch + one_week_bf, data = jp_2011)
summary(model0a)
plot(jp_2011$amount ~ jp_2011$week, col = "red", pch = 20)
lines(3:13, model0$fitted, col="blue")
lines(2:13, model0a$fitted, col="orange")
fit <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch_2012, week = week)
for (i in 1:8) {
predicted <- predict(model0a, newdata)
newdata$amount[i+5] <- predicted[i+5]
try(newdata$one_week_bf[i+6] <- predicted[i+5])
}
return(newdata)
newdata2 <- newdata
}
launch_2011 <- c(rep('bf',3), 'launch', rep('af',9))
newdata3 <- fit(jp_total_2011, jp_one_week_bf_2011, launch_2011)
View(newdata3)
fit <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:8) {
predicted <- predict(model0a, newdata)
newdata$amount[i+5] <- predicted[i+5]
try(newdata$one_week_bf[i+6] <- predicted[i+5])
}
return(newdata)
}
newdata3 <- fit(jp_total_2011, jp_one_week_bf_2011, launch_2011)
View(newdata3)
lines(1:13, newdata3$amount, col = 'green')
fit2 <- function(x, y, z, a) {
amount <- x
one_week_bf <- y
two_week_bf <- z
launch <- a
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, two_week_bf = two_week_bf, launch = launch, week = week)
for (i in 1:8) {
predicted <- predict(model0a, newdata)
newdata$amount[i+5] <- predicted[i+5]
try(newdata$one_week_bf[i+6] <- predicted[i+5])
}
return(newdata)
}
fit2 <- function(x, y, z, a) {
amount <- x
one_week_bf <- y
two_week_bf <- z
launch <- a
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, two_week_bf = two_week_bf, launch = launch, week = week)
for (i in 1:8) {
predicted <- predict(model0a, newdata)
newdata$amount[i+5] <- predicted[i+5]
try(newdata$one_week_bf[i+6] <- predicted[i+5])
try(newdata$two_week_bf[i+7] <- predicted[i+5])
}
return(newdata)
}
jp_two_week_bf_2011 <- c(NA, NA, 5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648, 6597)
View(newdata3)
jp_total_2012a <- c(7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA, NA, NA)
jp_one_week_bf_2012a <- c(NA, 7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA, NA)
jp_two_week_bf_2012a <- c(NA, NA, 7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA)
jp_three_week_bf_2012a <- c(NA, NA, NA, 7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA)
View(newdata3)
newdata3 <- fit(jp_total_2011, jp_one_week_bf_2011, jp_two_week_bf_2011, launch_2011)
newdata3 <- fit2(jp_total_2011, jp_one_week_bf_2011, jp_two_week_bf_2011, launch_2011)
View(newdata3)
newdata2 <- fit1(jp_total_2011, jp_one_week_bf_2011, launch_2011)
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:8) {
predicted <- predict(model0a, newdata)
newdata$amount[i+5] <- predicted[i+5]
try(newdata$one_week_bf[i+6] <- predicted[i+5])
}
return(newdata)
}
newdata2 <- fit1(jp_total_2011, jp_one_week_bf_2011, launch_2011)
View(newdata2)
newdata3 <- fit2(jp_total_2011, jp_one_week_bf_2011, jp_two_week_bf_2011, launch_2011)
View(newdata3)
rm(newdata2)
newdata2 <- fit1(jp_total_2011, jp_one_week_bf_2011, launch_2011)
View(newdata2)
rm(newdata3)
newdata3 <- fit2(jp_total_2011, jp_one_week_bf_2011, jp_two_week_bf_2011, launch_2011)
View(newdata3)
fit2 <- function(x, y, z, a) {
amount <- x
one_week_bf <- y
two_week_bf <- z
launch <- a
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, two_week_bf = two_week_bf, launch = launch, week = week)
for (i in 1:8) {
predicted <- predict(model0, newdata)
newdata$amount[i+5] <- predicted[i+5]
try(newdata$one_week_bf[i+6] <- predicted[i+5])
try(newdata$two_week_bf[i+7] <- predicted[i+5])
}
return(newdata)
}
newdata3 <- fit2(jp_total_2011, jp_one_week_bf_2011, jp_two_week_bf_2011, launch_2011)
View(newdata3)
plot(jp_2011$amount ~ jp_2011$week, col = "red", pch = 20)
lines(3:13, model0$fitted, col="blue")
lines(2:13, model0a$fitted, col="orange")
lines(1:13, newdata2$amount, col = 'green')
lines(1:13, newdata3$amount, col = 'pink')
rm(newdata2)
rm(newdata3)
jp_total_2012a <- c(7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA, NA, NA)
jp_one_week_bf_2012a <- c(NA, 7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA, NA)
jp_two_week_bf_2012a <- c(NA, NA, 7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA)
newdata2 <- fit1(jp_total_2012a, jp_one_week_bf_2012a, launch_2011)
View(newdata2)
newdata2 <- fit1(jp_total_2012a, jp_one_week_bf_2012a, launch_2011)
View(newdata2)
launch_2012 <- c(rep('bf', 5), 'launch', rep('af', 7))
newdata2 <- fit1(jp_total_2012a, jp_one_week_bf_2012a, launch_2012)
View(newdata2)
newdata3 <- fit2(jp_total_2012a, jp_one_week_bf_2012a, jp_two_week_bf_2012a, launch_2012)
View(newdata3)
plot(jp_2011$amount ~ jp_2011$week, col = "red", pch = 20)
points(1:13, jp_total_2012a, col = 'blue', pch = 20)
lines(1:13, newdata2$amount, col = 'green')
lines(1:13, newdata3$amount, col = 'pink')
View(newdata2)
View(newdata3)
plot(jp_2011$amount ~ jp_2011$week, col = "red", pch = 20)
points(1:13, jp_total_2012a, col = 'blue', pch = 20)
lines(1:13, newdata2$amount, col = 'green')
plot(jp_2011$amount ~ jp_2011$week, col = "red", pch = 20)
points(1:13, jp_total_2012a, col = 'blue', pch = 20)
lines(1:13, newdata3$amount, col = 'pink')
newdata2 <- fit1(jp_total_2011, jp_one_week_bf_2011, launch_2011)
View(newdata2)
newdata3 <- fit2(jp_total_2011, jp_one_week_bf_2011, jp_two_week_bf_2011, launch_2011)
View(newdata3)
plot(jp_2011$amount ~ jp_2011$week, col = "red", pch = 20)
lines(1:13, newdata2$amount, col = 'green')
lines(1:13, newdata3$amount, col = 'pink')
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:13) {
predicted <- predict(model0a, newdata)
newdata$amount[i] <- predicted[i]
try(newdata$one_week_bf[i+1] <- predicted[i])
}
return(newdata)
}
newdata2 <- fit1(jp_total_2011, jp_one_week_bf_2011, launch_2011)
View(newdata2)
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:13) {
predicted <- predict(model0a, newdata)
newdata$amount[i] <- predicted[i]
try(newdata$one_week_bf[i+1] <- predicted[i])
}
return(newdata)
}
fit1 <- function(x, y, z) {
amount <- x
one_week_bf <- y
launch <- z
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, launch = launch, week = week)
for (i in 1:12) {
predicted <- predict(model0a, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
}
return(newdata)
}
newdata2 <- fit1(jp_total_2011, jp_one_week_bf_2011, launch_2011)
View(newdata2)
newdata2 <- fit1(jp_total_2012a, jp_one_week_bf_2012a, launch_2012)
View(newdata2)
lines(1:13, newdata2$amount, col = 'green')
points(1:13, jp_total_2012a, col = 'blue', pch = 20)
# function with amount ~ launch + one_week_before + two_week_before
fit2 <- function(x, y, z, a) {
amount <- x
one_week_bf <- y
two_week_bf <- z
launch <- a
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, two_week_bf = two_week_bf, launch = launch, week = week)
for (i in 1:2) {
predicted <- predict(model0, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
try(newdata$two_week_bf[i+3] <- predicted[i+1])
}
return(newdata)
}
newdata3 <- fit2(jp_total_2011, jp_one_week_bf_2011, jp_two_week_bf_2011, launch_2011)
View(newdata3)
newdata2 <- fit1(jp_total_2011, jp_one_week_bf_2011, launch_2011)
View(newdata2)
newdata3 <- fit2(jp_total_2011, jp_one_week_bf_2011, jp_two_week_bf_2011, launch_2011)
View(newdata3)
fit2 <- function(x, y, z, a) {
amount <- x
one_week_bf <- y
two_week_bf <- z
launch <- a
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, two_week_bf = two_week_bf, launch = launch, week = week)
for (i in 1:12) {
predicted <- predict(model0, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
try(newdata$two_week_bf[i+3] <- predicted[i+1])
}
return(newdata)
}
newdata3 <- fit2(jp_total_2011, jp_one_week_bf_2011, jp_two_week_bf_2011, launch_2011)
View(newdata3)
fit2 <- function(x, y, z, a) {
amount <- x
one_week_bf <- y
two_week_bf <- z
launch <- a
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, two_week_bf = two_week_bf, launch = launch, week = week)
for (i in 1:11) {
predicted <- predict(model0, newdata)
newdata$amount[i+1] <- predicted[i+1]
try(newdata$one_week_bf[i+2] <- predicted[i+1])
try(newdata$two_week_bf[i+3] <- predicted[i+1])
}
return(newdata)
}
newdata3 <- fit2(jp_total_2011, jp_one_week_bf_2011, jp_two_week_bf_2011, launch_2011)
View(newdata3)
fit2 <- function(x, y, z, a) {
amount <- x
one_week_bf <- y
two_week_bf <- z
launch <- a
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, two_week_bf = two_week_bf, launch = launch, week = week)
for (i in 1:11) {
predicted <- predict(model0, newdata)
newdata$amount[i+2] <- predicted[i+1]
try(newdata$one_week_bf[i+3] <- predicted[i+1])
try(newdata$two_week_bf[i+4] <- predicted[i+1])
}
return(newdata)
}
newdata3 <- fit2(jp_total_2011, jp_one_week_bf_2011, jp_two_week_bf_2011, launch_2011)
View(newdata3)
newdata2 <- fit1(jp_total_2011, jp_one_week_bf_2011, launch_2011)
View(newdata2)
rm(newdata2)
newdata2 <- fit1(jp_total_2011, jp_one_week_bf_2011, launch_2011)
View(newdata2)
fit2 <- function(x, y, z, a) {
amount <- x
one_week_bf <- y
two_week_bf <- z
launch <- a
newdata <- data.frame(amount = amount, one_week_bf = one_week_bf, two_week_bf = two_week_bf, launch = launch, week = week)
for (i in 1:11) {
predicted <- predict(model0, newdata)
newdata$amount[i+2] <- predicted[i+2]
try(newdata$one_week_bf[i+3] <- predicted[i+2])
try(newdata$two_week_bf[i+4] <- predicted[i+2])
}
return(newdata)
}
newdata3 <- fit2(jp_total_2011, jp_one_week_bf_2011, jp_two_week_bf_2011, launch_2011)
View(newdata3)
newdata3 <- fit2(jp_total_2012a, jp_one_week_bf_2012a, jp_two_week_bf_2012a, launch_2012)
View(newdata3)
lines(1:13, newdata3$amount, col = 'pink')
lines(1:13, newdata2$amount, col = 'green')
plot(jp_2011$amount ~ jp_2011$week, col = "red", pch = 20)
points(1:13, jp_total_2012a, col = 'blue', pch = 20)
newdata2 <- fit1(jp_total_2011, jp_one_week_bf_2011, launch_2011)
newdata3 <- fit2(jp_total_2011, jp_one_week_bf_2011, jp_two_week_bf_2011, launch_2011)
lines(1:13, newdata2$amount, col = 'green')
lines(1:13, newdata3$amount, col = 'pink')
newdata2 <- fit1(jp_total_2012a, jp_one_week_bf_2012a, launch_2012)
newdata3 <- fit2(jp_total_2012a, jp_one_week_bf_2012a, jp_two_week_bf_2012a, launch_2012)
lines(1:13, newdata2$amount, col = 'green')
lines(1:13, newdata3$amount, col = 'pink')
plot(jp_2011$amount ~ jp_2011$week, col = "red", pch = 20)
newdata2 <- fit1(jp_total_2011, jp_one_week_bf_2011, launch_2011)
newdata3 <- fit2(jp_total_2011, jp_one_week_bf_2011, jp_two_week_bf_2011, launch_2011)
lines(1:13, newdata2$amount, col = 'green')
lines(1:13, newdata3$amount, col = 'pink')
plot(jp_2011$amount ~ jp_2011$week, col = "red", pch = 20)
points(1:13, jp_total_2012a, col = 'blue', pch = 20)
newdata2 <- fit1(jp_total_2012a, jp_one_week_bf_2012a, launch_2012)
newdata3 <- fit2(jp_total_2012a, jp_one_week_bf_2012a, jp_two_week_bf_2012a, launch_2012)
lines(1:13, newdata2$amount, col = 'green')
lines(1:13, newdata3$amount, col = 'pink')
plot(jp_2011$amount ~ jp_2011$week, col = "red", pch = 20)
points(1:13, jp_total_2012a, col = 'blue', pch = 20)
lines(1:13, newdata2$amount, col = 'green')
lines(1:13, newdata3$amount, col = 'pink')
jp_2011 <- data.frame(amount = jp_total_2011, one_week_bf = jp_one_week_bf_2011, two_week_bf = jp_two_week_bf_2011, three_week_bf = jp_three_week_bf_2011, launch = launch, week = week)
View(jp_2011)
newdata <- data.frame(amount = jp_total_2012a, one_week_bf = jp_one_week_bf_2012a, launch = launch_2012, week = week)
View(newdata)
jp_b_2wbf_2012 <- c(NA, NA, 1943, 1602, 1441, 1297, 1258, NA, NA, NA, NA, NA, NA)
week <- 1:13
launch_2011 <- c(rep('bf',3), 'launch', rep('af',9))
jp_total_2011 <- c(5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648, 6597, 6795, 6659)
jp_total_1wbf_2011 <- c(NA, 5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648, 6597, 6795)
jp_total_2wbf_2011 <- c(NA, NA, 5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648, 6597)
jp_2011_data <- data.frame(amount = jp_total_2011, one_week_bf = jp_total_1wbf_2011, two_week_bf = jp_total_2wbf_2011, week = weeks, launch = launch_2011)
week <- 1:13
launch_2011 <- c(rep('bf',3), 'launch', rep('af',9))
jp_total_2011 <- c(5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648, 6597, 6795, 6659)
jp_total_1wbf_2011 <- c(NA, 5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648, 6597, 6795)
jp_total_2wbf_2011 <- c(NA, NA, 5297, 4398, 4979, 13445, 10433, 9390, 8920, 8474, 8051, 7648, 6597)
jp_2011_data <- data.frame(amount = jp_total_2011, one_week_bf = jp_total_1wbf_2011, two_week_bf = jp_total_2wbf_2011, week = week, launch = launch_2011)
View(jp_2011_data)
week <- 1:13
launch_2012 <- c(rep('bf',5), 'launch', rep('af',7))
jp_total_2012 <- c(7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA, NA, NA)
<<<<<<< HEAD
jp_one_week_bf_2012 <- c(NA, 7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA, NA)
jp_two_week_bf_2012 <- c(NA, NA, 7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA)
launch_2012 <- c(rep('bf', 5), 'launch', rep('af', 7))
newdata <- data.frame(amount = jp_total_2012, one_week_bf = jp_one_week_bf_2012, two_week_bf = jp_two_week_bf_2012, launch = launch_2012, week = week)
View(newdata)
predict(model0, newdata)
predict(model0, newdata, interval='predict')
predict(model0, newdata, interval='predict')
View(predict(model0, newdata, interval='predict'))
jp_total_2012 <- c(7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA, NA, NA)
jp_one_week_bf_2012 <- c(NA, 7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA, NA)
jp_two_week_bf_2012 <- c(NA, NA, 7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA)
launch_2012 <- c(rep('bf', 5), 'launch', rep('af', 7))
newdata <- data.frame(amount = jp_total_2012, one_week_bf = jp_one_week_bf_2012, two_week_bf = jp_two_week_bf_2012, launch = launch_2012, week = week)
View(newdata)
View(predict(model0, newdata, interval='predict'))
?predict
View(predict(model0, newdata, interval='predict'))
View(predict(model0, newdata))
jp_total_2012 <- c(7946, 6641, 5975, 5378, 5217, 13700, NA, NA, NA, NA, NA, NA, NA)
jp_one_week_bf_2012 <- c(NA, 7946, 6641, 5975, 5378, 5217, 13700, NA, NA, NA, NA, NA, NA)
jp_two_week_bf_2012 <- c(NA, NA, 7946, 6641, 5975, 5378, 5217, 13700, NA, NA, NA, NA, NA)
launch_2012 <- c(rep('bf', 5), 'launch', rep('af', 7))
newdata <- data.frame(amount = jp_total_2012, one_week_bf = jp_one_week_bf_2012, two_week_bf = jp_two_week_bf_2012, launch = launch_2012, week = week)
View(newdata)
View(predict(model0, newdata))
jp_total_2012 <- c(7946, 6641, 5975, 5378, 5217, 13700, 10642, NA, NA, NA, NA, NA, NA)
jp_one_week_bf_2012 <- c(NA, 7946, 6641, 5975, 5378, 5217, 13700, 10642, NA, NA, NA, NA, NA)
jp_two_week_bf_2012 <- c(NA, NA, 7946, 6641, 5975, 5378, 5217, 13700, 10642, NA, NA, NA, NA)
launch_2012 <- c(rep('bf', 5), 'launch', rep('af', 7))
newdata <- data.frame(amount = jp_total_2012, one_week_bf = jp_one_week_bf_2012, two_week_bf = jp_two_week_bf_2012, launch = launch_2012, week = week)
View(newdata)
View(predict(model0, newdata))
jp_total_2012 <- c(7946, 6641, 5975, 5378, 5217, 13700, 10642, 9757, NA, NA, NA, NA, NA)
jp_one_week_bf_2012 <- c(NA, 7946, 6641, 5975, 5378, 5217, 13700, 10642, 9757, NA, NA, NA, NA)
jp_two_week_bf_2012 <- c(NA, NA, 7946, 6641, 5975, 5378, 5217, 13700, 10642, 9757, NA, NA, NA)
launch_2012 <- c(rep('bf', 5), 'launch', rep('af', 7))
newdata <- data.frame(amount = jp_total_2012, one_week_bf = jp_one_week_bf_2012, two_week_bf = jp_two_week_bf_2012, launch = launch_2012, week = week)
View(newdata)
View(predict(model0, newdata))
jp_total_2012 <- c(7946, 6641, 5975, 5378, 5217, 13700, 10642, 9757, 8874, NA, NA, NA, NA)
jp_one_week_bf_2012 <- c(NA, 7946, 6641, 5975, 5378, 5217, 13700, 10642, 9757, 8874, NA, NA, NA)
jp_two_week_bf_2012 <- c(NA, NA, 7946, 6641, 5975, 5378, 5217, 13700, 10642, 9757, 8874, NA, NA)
launch_2012 <- c(rep('bf', 5), 'launch', rep('af', 7))
newdata <- data.frame(amount = jp_total_2012, one_week_bf = jp_one_week_bf_2012, two_week_bf = jp_two_week_bf_2012, launch = launch_2012, week = week)
View(newdata)
View(predict(model0, newdata))
jp_total_2012 <- c(7946, 6641, 5975, 5378, 5217, 13700, 10642, 9757, 8874, 8239, NA, NA, NA)
jp_one_week_bf_2012 <- c(NA, 7946, 6641, 5975, 5378, 5217, 13700, 10642, 9757, 8874, 8239, NA, NA)
jp_two_week_bf_2012 <- c(NA, NA, 7946, 6641, 5975, 5378, 5217, 13700, 10642, 9757, 8874, 8239, NA)
launch_2012 <- c(rep('bf', 5), 'launch', rep('af', 7))
newdata <- data.frame(amount = jp_total_2012, one_week_bf = jp_one_week_bf_2012, two_week_bf = jp_two_week_bf_2012, launch = launch_2012, week = week)
View(newdata)
View(predict(model0, newdata))
jp_total_2012 <- c(7946, 6641, 5975, 5378, 5217, 13700, 10642, 9757, 8874, 8239, 7755, NA, NA)
jp_one_week_bf_2012 <- c(NA, 7946, 6641, 5975, 5378, 5217, 13700, 10642, 9757, 8874, 8239, 7755, NA)
jp_two_week_bf_2012 <- c(NA, NA, 7946, 6641, 5975, 5378, 5217, 13700, 10642, 9757, 8874, 8239, 7755)
launch_2012 <- c(rep('bf', 5), 'launch', rep('af', 7))
newdata <- data.frame(amount = jp_total_2012, one_week_bf = jp_one_week_bf_2012, two_week_bf = jp_two_week_bf_2012, launch = launch_2012, week = week)
View(newdata)
View(predict(model0, newdata))
jp_total_2012 <- c(7946, 6641, 5975, 5378, 5217, 13700, 10642, 9757, 8874, 8239, 7755, 7390, NA)
jp_one_week_bf_2012 <- c(NA, 7946, 6641, 5975, 5378, 5217, 13700, 10642, 9757, 8874, 8239, 7755, 7390)
jp_two_week_bf_2012 <- c(NA, NA, 7946, 6641, 5975, 5378, 5217, 13700, 10642, 9757, 8874, 8239, 7755)
launch_2012 <- c(rep('bf', 5), 'launch', rep('af', 7))
newdata <- data.frame(amount = jp_total_2012, one_week_bf = jp_one_week_bf_2012, two_week_bf = jp_two_week_bf_2012, launch = launch_2012, week = week)
View(newdata)
View(predict(model0, newdata))
plot(jp_2011$amount ~ jp_2011$week, col = "red", type = 'l')
lines(1:5, jp_total_2012a, col = 'blue')
jp_total_2012a <- c(7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA, NA NA)
jp_total_2012a <- c(7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA, NA, NA)
lines(1:5, jp_total_2012a, col = 'blue')
lines(2:5, jp_total_2012a, col = 'blue')
lines(1:6, jp_total_2012a, col = 'blue')
lines(1:6, jp_total_2012a, col = 'blue')
lines(1:13, jp_total_2012a, col = 'blue')
lines(1:13, predict(model0, newdata), col='green')
View(predict(model0, newdata))
=======
jp_total_1wbf_2012 <- c(NA, 7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA, NA)
jp_total_2wbf_2012 <- c(NA, NA, 7946, 6641, 5975, 5378, 5217, NA, NA, NA, NA, NA, NA)
jp_2012_data <- data.frame(amount = jp_total_2012, one_week_bf = jp_total_1wbf_2012, two_week_bf = jp_total_2wbf_2012, week = week, launch = launch_2012)
View(jp_2012_data)
jp_s_2012 <- c(2394, 2027, 1824, 1642, 1593, NA, NA, NA, NA, NA, NA, NA, NA)
jp_s_1wbf_2012 <- c(NA, 2394, 2027, 1824, 1642, 1593, NA, NA, NA, NA, NA, NA, NA)
jp_s_2wbf_2012 <- c(NA, NA, 2394, 2027, 1824, 1642, 1593, NA, NA, NA, NA, NA, NA)
jp_s_2012_data <- data.frame(amount = jp_s_2012, one_week_bf = jp_s_1wbf_2012, two_week_bf = jp_s_2wbf_2012, week = week, launch = launch_2012)
View(jp_2012_data)
jp_s_2012 <- c(2394, 2027, 1824, 1642, 1593, NA, NA, NA, NA, NA, NA, NA, NA)
jp_s_1wbf_2012 <- c(NA, 2394, 2027, 1824, 1642, 1593, NA, NA, NA, NA, NA, NA, NA)
jp_s_2wbf_2012 <- c(NA, NA, 2394, 2027, 1824, 1642, 1593, NA, NA, NA, NA, NA, NA)
jp_s_2012_data <- data.frame(amount = jp_s_2012, one_week_bf = jp_s_1wbf_2012, two_week_bf = jp_s_2wbf_2012, week = week, launch = launch_2012)
View(jp_s_2012_data)
jp_p_2012 <- c(1645, 1403, 1263, 1136, 1102, NA, NA, NA, NA, NA, NA, NA, NA)
jp_p_1wbf_2012 <- c(NA, 1645, 1403, 1263, 1136, 1102, NA, NA, NA, NA, NA, NA, NA)
jp_p_2wbf_2012 <- c(NA, NA, 1645, 1403, 1263, 1136, 1102, NA, NA, NA, NA, NA, NA)
jp_p_2012_data <- data.frame(amount = jp_p_2012, one_week_bf = jp_p_1wbf_2012, two_week_bf = jp_p_2wbf_2012, week = week, launch = launch_2012)
View(jp_p_2012_data)
jp_r_2012 <- c(679, 567, 510, 459, 445, NA, NA, NA, NA, NA, NA, NA, NA)
jp_r_1wbf_2012 <- c(NA, 679, 567, 510, 459, 445, NA, NA, NA, NA, NA, NA, NA)
jp_r_2wbf_2012 <- c(NA, NA, 679, 567, 510, 459, 445, NA, NA, NA, NA, NA, NA)
jp_r_2012_data <- data.frame(amount = jp_r_2012, one_week_bf = jp_r_1wbf_2012, two_week_bf = jp_r_2wbf_2012, week = week, launch = launch_2012)
View(jp_r_2012_data)
jp_g_2012 <- c(1285, 1042, 937, 844, 819, NA, NA, NA, NA, NA, NA, NA, NA)
jp_g_1wbf2012 <- c(NA, 1285, 1042, 937, 844, 819, NA, NA, NA, NA, NA, NA, NA)
jp_g_2wbf2012 <- c(NA, NA, 1285, 1042, 937, 844, 819, NA, NA, NA, NA, NA, NA)
jp_g_2012_data <- data.frame(amount = jp_g_2012, one_week_bf = jp_g_1wbf_2012, two_week_bf = jp_r_2wbf_2012, week = week, launch = launch_2012)
View(jp_g_2012_data)
jp_g_2012 <- c(1285, 1042, 937, 844, 819, NA, NA, NA, NA, NA, NA, NA, NA)
jp_g_1wbf2012 <- c(NA, 1285, 1042, 937, 844, 819, NA, NA, NA, NA, NA, NA, NA)
jp_g_2wbf2012 <- c(NA, NA, 1285, 1042, 937, 844, 819, NA, NA, NA, NA, NA, NA)
jp_g_2012_data <- data.frame(amount = jp_g_2012, one_week_bf = jp_g_1wbf_2012, two_week_bf = jp_g_2wbf_2012, week = week, launch = launch_2012)
View(jp_g_2012_data)
jp_g_2012 <- c(1285, 1042, 937, 844, 819, NA, NA, NA, NA, NA, NA, NA, NA)
jp_g_1wbf_2012 <- c(NA, 1285, 1042, 937, 844, 819, NA, NA, NA, NA, NA, NA, NA)
jp_g_2wbf_2012 <- c(NA, NA, 1285, 1042, 937, 844, 819, NA, NA, NA, NA, NA, NA)
jp_g_2012_data <- data.frame(amount = jp_g_2012, one_week_bf = jp_g_1wbf_2012, two_week_bf = jp_g_2wbf_2012, week = week, launch = launch_2012)
View(jp_g_2012_data)
jp_b_2012 <- c(1943, 1602, 1441, 1297, 1258, NA, NA, NA, NA, NA, NA, NA, NA)
jp_b_1wbf_2012 <- c(NA, 1943, 1602, 1441, 1297, 1258, NA, NA, NA, NA, NA, NA, NA)
jp_b_2wbf_2012 <- c(NA, NA, 1943, 1602, 1441, 1297, 1258, NA, NA, NA, NA, NA, NA)
jp_b_2012_data <- data.frame(amount = jp_b_2012, one_week_bf = jp_b_1wbf_2012, two_week_bf = jp_b_2wbf_2012, week = week, launch = launch_2012)
View(jp_b_2012_data)
week <- 1:13
launch_2011 <- c(rep('bf',3), 'launch', rep('af',9))
sa_total_2011 <- c(2375, 2172, 2033, 4573, 5545, 4436, 3549, 3371, 3203, 3042, 2982, 3041, 3072)
sa_total_1wbf_2011 <- c(NA, 2375, 2172, 2033, 4573, 5545, 4436, 3549, 3371, 3203, 3042, 2982, 3041)
sa_total_2wbf_2011 <- c(NA, NA, 2375, 2172, 2033, 4573, 5545, 4436, 3549, 3371, 3203, 3042, 2982)
sa_2011_data <- data.frame(amount = sa_total_2011, one_week_bf = sa_total_1wbf_2011, two_week_bf = sa_total_2wbf_2011, week = week, launch = launch_2011)
View(sa_2011_data)
sa_total_2012 <- c(3325, 2823, 2541, 2286, 2218, NA, NA, NA, NA, NA, NA, NA, NA)
sa_total_1wbf_2012 <- c(NA, 3325, 2823, 2541, 2286, 2218, NA, NA, NA, NA, NA, NA, NA)
sa_total_2wbf_2012 <- c(NA, NA, 3325, 2823, 2541, 2286, 2218, NA, NA, NA, NA, NA, NA)
sa_2012_data <- data.frame(amount = sa_total_2012, one_week_bf = sa_total_1wbf_2012, two_week_bf = sa_total_2wbf_2012, week = week, launch = launch_2012)
View(sa_2012_data)
sa_s_2012 <- c(2106, 1783, 1604, 1444, 1401, NA, NA, NA, NA, NA, NA, NA, NA)
sa_s_1wbf_2012 <- c(NA, 2106, 1783, 1604, 1444, 1401, NA, NA, NA, NA, NA, NA, NA)
sa_s_2wbf_2012 <- c(NA, NA, 2106, 1783, 1604, 1444, 1401, NA, NA, NA, NA, NA, NA)
sa_s_2012_data <- data.frame(amount = sa_s_2012, one_week_bf = sa_s_1wbf_2012, two_week_bf = sa_s_2wbf_2012, week = week, launch = launch_2012)
View(sa_s_2012_data)
sa_p_2012 <- c(2106, 1783, 1604, 1444, 1401, NA, NA, NA, NA, NA, NA, NA, NA)
sa_p_1wbf_2012 <- c(NA, 2106, 1783, 1604, 1444, 1401, NA, NA, NA, NA, NA, NA, NA)
sa_p_2wbf_2012 <- c(NA, NA, 2106, 1783, 1604, 1444, 1401, NA, NA, NA, NA, NA, NA)
sa_p_2012_data <- data.frame(amount = sa_p_2012, one_week_bf = sa_p_1wbf_2012, two_week_bf = sa_p_2wbf_2012, week = week, launch = launch_2012)
View(sa_p_2012_data)
sa_p_2012 <- c(1220, 1040, 937, 842, 817, NA, NA, NA, NA, NA, NA, NA, NA)
sa_p_1wbf_2012 <- c(NA, 1220, 1040, 937, 842, 817, NA, NA, NA, NA, NA, NA, NA)
sa_p_2wbf_2012 <- c(NA, NA, 1220, 1040, 937, 842, 817, NA, NA, NA, NA, NA, NA)
sa_p_2012_data <- data.frame(amount = sa_p_2012, one_week_bf = sa_p_1wbf_2012, two_week_bf = sa_p_2wbf_2012, week = week, launch = launch_2012)
View(sa_p_2012_data)
View(sa_p_2012_data)
sa_r_2012 <- c(644, 548, 493, 444, 430, NA, NA, NA, NA, NA, NA, NA, NA)
sa_r_1wbf_2012 <- c(NA, 644, 548, 493, 444, 430, NA, NA, NA, NA, NA, NA, NA)
sa_r_2wbf_2012 <- c(NA, NA, 644, 548, 493, 444, 430, NA, NA, NA, NA, NA, NA)
sa_r_2012_data <- data.frame(amount = sa_r_2012, one_week_bf = sa_r_1wbf_2012, two_week_bf = sa_r_2wbf_2012, week = week, launch = launch_2012)
View(sa_r_2012_data)
sa_g_2012 <- c(847, 720, 648, 583, 565, NA, NA, NA, NA, NA, NA, NA, NA)
sa_g_1wbf_2012 <- c(NA, 847, 720, 648, 583, 565, NA, NA, NA, NA, NA, NA, NA)
sa_g_2wbf_2012 <- c(NA, NA, 847, 720, 648, 583, 565, NA, NA, NA, NA, NA, NA)
sa_g_2012_data <- data.frame(amount = sa_g_2012, one_week_bf = sa_g_1wbf_2012, two_week_bf = sa_g_2wbf_2012, week = week, launch = launch_2012)
View(sa_g_2012_data)
sa_b_2012 <- c(1738, 1477, 1329, 1196, 1160, NA, NA, NA, NA, NA, NA, NA, NA)
sa_b_1wbf_2012 <- c(NA, 1738, 1477, 1329, 1196, 1160, NA, NA, NA, NA, NA, NA, NA)
sa_b_2wbf_2012 <- c(NA, NA, 1738, 1477, 1329, 1196, 1160, NA, NA, NA, NA, NA, NA)
sa_b_2012_data <- data.frame(amount = sa_b_2012, one_week_bf = sa_b_1wbf_2012, two_week_bf = sa_b_2wbf_2012, week = week, launch = launch_2012)
View(sa_b_2012_data)
nz_total_2011 <- c(3700, 3333, 3119, 7018, 8509, 6807, 5446, 5173, 4915, 4669, 4576, 4667, 4714)
nz_total_1wbf_2011 <- c(NA, 3700, 3333, 3119, 7018, 8509, 6807, 5446, 5173, 4915, 4669, 4576, 4667)
nz_total_2wbf_2011 <- c(NA, NA, 3700, 3333, 3119, 7018, 8509, 6807, 5446, 5173, 4915, 4669, 4576)
nz_2011_data <- data.frame(amount = nz_total_2011, one_week_bf = nz_total_1wbf_2011, two_week_bf = nz_total_2wbf_2011, week = week, launch = launch_2011)
View(nz_2011_data)
nz_total_2012 <- c(5181, 4333, 3898, 3509, 3403, NA, NA, NA, NA, NA, NA, NA, NA)
nz_total_1wbf_2012 <- c(NA, 5181, 4333, 3898, 3509, 3403, NA, NA, NA, NA, NA, NA, NA)
nz_total_2wbf_2012 <- c(NA, NA, 5181, 4333, 3898, 3509, 3403, NA, NA, NA, NA, NA, NA)
nz_2012_data <- data.frame(amount = nz_total_2012, one_week_bf = nz_total_1wbf_2012, two_week_bf = nz_total_2wbf_2012, week = week, launch = launch_2012)
View(nz_2012_data)
nz_s_2012 <- c(1817, 1538, 1384, 1246, 1209, NA, NA, NA, NA, NA, NA, NA, NA)
nz_s_1wbf_2012 <- c(NA, 1817, 1538, 1384, 1246, 1209, NA, NA, NA, NA, NA, NA, NA)
nz_s_2wbf_2012 <- c(NA, NA, 1817, 1538, 1384, 1246, 1209, NA, NA, NA, NA, NA, NA)
nz_s_2012_data <- data.frame(amount = nz_s_2012, one_week_bf = nz_s_1wbf_2012, two_week_bf = nz_s_2wbf_2012, week = week, launch = launch_2012)
View(nz_s_2012_data)
nz_p_2012 <- c(795, 678, 610, 549, 532, NA, NA, NA, NA, NA, NA, NA, NA)
nz_p_1wbf_2012 <- c(NA, 795, 678, 610, 549, 532, NA, NA, NA, NA, NA, NA, NA)
nz_p_2wbf_2012 <- c(NA, NA, 795, 678, 610, 549, 532, NA, NA, NA, NA, NA, NA)
nz_p_2012_data <- data.frame(amount = nz_p_2012, one_week_bf = nz_p_1wbf_2012, two_week_bf = nz_p_2wbf_2012, week = week, launch = launch_2012)
View(nz_p_2012_data)
nz_r_2012 <- c(562, 469, 422, 380, 369, NA, NA, NA, NA, NA, NA, NA, NA)
nz_r_1wbf_2012 <- c(NA, 562, 469, 422, 380, 369, NA, NA, NA, NA, NA, NA, NA)
nz_r_2wbf_2012 <- c(NA, NA, 562, 469, 422, 380, 369, NA, NA, NA, NA, NA, NA)
nz_r_2012_data <- data.frame(amount = nz_r_2012, one_week_bf = nz_r_1wbf_2012, two_week_bf = nz_r_2wbf_2012, week = week, launch = launch_2012)
View(nz_r_2012_data)
nz_g_2012 <- c(532, 431, 388, 349, 339, NA, NA, NA, NA, NA, NA, NA, NA)
nz_g_1wbf_2012 <- c(NA, 532, 431, 388, 349, 339, NA, NA, NA, NA, NA, NA, NA)
nz_g_2wbf_2012 <- c(NA, NA, 532, 431, 388, 349, 339, NA, NA, NA, NA, NA, NA)
nz_g_2012_data <- data.frame(amount = nz_g_2012, one_week_bf = nz_g_1wbf_2012, two_week_bf = nz_g_2wbf_2012, week = week, launch = launch_2012)
View(nz_g_2012_data)
nz_b_2012 <- c(1475, 1216, 1094, 984, 955, NA, NA, NA, NA, NA, NA, NA, NA)
nz_b_1wbf_2012 <- c(NA, 1475, 1216, 1094, 984, 955, NA, NA, NA, NA, NA, NA, NA)
nz_b_2wbf_2012 <- c(NA, NA, 1475, 1216, 1094, 984, 955, NA, NA, NA, NA, NA, NA)
nz_b_2012_data <- data.frame(amount = nz_b_2012, one_week_bf = nz_b_1wbf_2012, two_week_bf = nz_b_2wbf_2012, week = week, launch = launch_2012)
View(nz_b_2012_data)
acf(japan_2011)
acf(japan_total_2011)
acf(jp_total_2011)
acf(jp_total_2011)
model1 <- lm(amount ~ launch + one_week_bf, data = jp_2total_011)
model1 <- lm(amount ~ launch + one_week_bf, data = jp_total_011)
model1 <- lm(amount ~ launch + one_week_bf, data = jp_total_2011)
model1 <- lm(amount ~ launch + one_week_bf, data = jp_2011_data)
summary(model1)
plot(model1)
model1b <- lm(amount ~ launch + one_week_bf + two_week_bf, data = jp_2011_data)
summary(model1b)
model1c <- lm(amount ~ launch*one_week_bf, data = jp_2011_data)
summary(model1c)
model2 <- lm(amount ~ launch + I(one_week_bf^2) + country, data = japan_2011_data1)
model2 <- lm(amount ~ launch + I(one_week_bf^2) + country, data = japan_2011_data)
model2 <- lm(amount ~ launch + I(one_week_bf^2) + country, data = jp_2011_data)
model2 <- lm(amount ~ launch + I(one_week_bf^2), data = jp_2011_data)
summary(model2)
model2b <- lm(amount ~ launch + I(one_week_bf^2) + I(two_week_bf^2), data = jp_2011_data)
summary(model2b)
plot(jp_2011$amount ~ jp_2011$week, col = "red", lwd = 1.5, pch = 20)
lines(3:13, model1$fitted, col="blue", lwd = 1.5)
lines(1:13, model1$fitted, col="blue", lwd = 1.5)
lines(2:13, model1$fitted, col="blue", lwd = 1.5)
lines(3:13, model1b$fitted, col="cyan")
lines(2:13, model1c$fitted, col="orange", lwd = 1.5)
lines(2:13, model2$fitted, col="blueviolet")
lines(3:13, model2b$fitted, col="green", lwd = 1.5)
>>>>>>> 700065015c0a0e42a6b74789294dba5aaa5f5671
